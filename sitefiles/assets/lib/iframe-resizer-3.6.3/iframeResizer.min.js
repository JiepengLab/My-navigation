!function(e){"use strict";function n(e,n,i){"addEventListener"in window?e.addEventListener(n,i,!1):"attachEvent"in window&&e.attachEvent("on"+n,i)}function i(e,n,i){"removeEventListener"in window?e.removeEventListener(n,i,!1):"detachEvent"in window&&e.detachEvent("on"+n,i)}function t(e){return W+"["+function(e){var n="Host page: "+e;return window.top!==window.self&&(n=window.parentIFrame&&window.parentIFrame.getId?window.parentIFrame.getId()+": "+e:"Nested host page: "+e),n}(e)+"]"}function o(e){return L[e]?L[e].log:O}function r(e,n){c("log",e,n,o(e))}function a(e,n){c("info",e,n,o(e))}function s(e,n){c("warn",e,n,!0)}function c(e,n,i,o){!0===o&&"object"==typeof window.console&&console[e](t(n),i)}function u(e){function t(){o("Height"),o("Width"),b(function(){p(z),g(R),x("resizedCallback",z)},z,"init")}function o(e){var n=Number(L[R]["max"+e]),i=Number(L[R]["min"+e]),t=e.toLowerCase(),o=Number(z[t]);r(R,"Checking "+t+" is in range "+i+"-"+n),o<i&&(o=i,r(R,"Set "+t+" to min value")),o>n&&(o=n,r(R,"Set "+t+" to max value")),z[t]=""+o}function c(e){return M.substr(M.indexOf(":")+N+e)}function u(e,n){I(function(){y("Send Page Info","pageInfo:"+function(){var e=document.body.getBoundingClientRect(),n=z.iframe.getBoundingClientRect();return JSON.stringify({iframeHeight:n.height,iframeWidth:n.width,clientHeight:Math.max(document.documentElement.clientHeight,window.innerHeight||0),clientWidth:Math.max(document.documentElement.clientWidth,window.innerWidth||0),offsetTop:parseInt(n.top-e.top,10),offsetLeft:parseInt(n.left-e.left,10),scrollTop:window.pageYOffset,scrollLeft:window.pageXOffset})}(),e,n)},32,n)}function f(e){var n=e.getBoundingClientRect();return m(R),{x:Math.floor(Number(n.left)+Number(S.x)),y:Math.floor(Number(n.top)+Number(S.y))}}function k(e){var n=e?f(z.iframe):{x:0,y:0},i={x:Number(z.width)+n.x,y:Number(z.height)+n.y};r(R,"Reposition requested from iFrame (offset x:"+n.x+" y:"+n.y+")"),window.top!==window.self?window.parentIFrame?window.parentIFrame["scrollTo"+(e?"Offset":"")](i.x,i.y):s(R,"Unable to scroll to requested position, window.parentIFrame not found"):(S=i,F(),r(R,"--"))}function F(){!1!==x("scrollCallback",S)?g(R):w()}function x(e,n){return d(R,e,n)}var M=e.data,z={},R=null;"[iFrameResizerChild]Ready"===M?function(){for(var e in L)y("iFrame requested init",v(e),document.getElementById(e),e)}():W===(""+M).substr(0,P)&&M.substr(P).split(":")[0]in L?(z=function(){var e=M.substr(P).split(":");return{iframe:L[e[0]]&&L[e[0]].iframe,id:e[0],height:e[1],width:e[2],type:e[3]}}(),R=z.id,L[R]&&(L[R].loaded=!0),!function(){var e=z.type in{true:1,false:1,undefined:1};return e&&r(R,"Ignoring init message from meta parent page"),e}()&&function(e){var n=!0;return L[e]||(n=!1,s(z.type+" No settings for "+e+". Message was: "+M)),n}(R)&&(r(R,"Received: "+M),function(){var e=!0;return null===z.iframe&&(s(R,"IFrame ("+z.id+") not found"),e=!1),e}()&&function(){var n=e.origin,i=L[R]&&L[R].checkOrigin;if(i&&""+n!="null"&&!(i.constructor===Array?function(){var e=0,t=!1;for(r(R,"Checking connection is from allowed list of origins: "+i);e<i.length;e++)if(i[e]===n){t=!0;break}return t}():function(){var e=L[R]&&L[R].remoteHost;return r(R,"Checking connection is from: "+e),n===e}()))throw new Error("Unexpected message received from: "+n+" for "+z.iframe.id+". Message was: "+e.data+". This error can be disabled by setting the checkOrigin: false option or by providing of array of trusted domains.");return!0}()&&function(){switch(L[R]&&L[R].firstRun&&L[R]&&(L[R].firstRun=!1),z.type){case"close":L[R].closeRequestCallback?d(R,"closeRequestCallback",L[R].iframe):l(z.iframe);break;case"message":e=c(6),r(R,"MessageCallback passed: {iframe: "+z.iframe.id+", message: "+e+"}"),x("messageCallback",{iframe:z.iframe,message:JSON.parse(e)}),r(R,"--");break;case"scrollTo":k(!1);break;case"scrollToOffset":k(!0);break;case"pageInfo":u(L[R]&&L[R].iframe,R),function(){function e(e,n){function i(){L[o]?u(L[o].iframe,o):t()}["scroll","resize"].forEach(function(t){r(o,e+t+" listener for sendPageInfo"),n(window,t,i)})}function t(){e("Remove ",i)}var o=R;e("Add ",n),L[o]&&(L[o].stopPageInfo=t)}();break;case"pageInfoStop":L[R]&&L[R].stopPageInfo&&(L[R].stopPageInfo(),delete L[R].stopPageInfo);break;case"inPageLink":!function(e){var n=e.split("#")[1]||"",i=decodeURIComponent(n),t=document.getElementById(i)||document.getElementsByName(i)[0];t?function(){var e=f(t);r(R,"Moving to in page link (#"+n+") at x: "+e.x+" y: "+e.y),S={x:e.x,y:e.y},F(),r(R,"--")}():window.top!==window.self?window.parentIFrame?window.parentIFrame.moveToAnchor(n):r(R,"In page link #"+n+" not found and window.parentIFrame not found"):r(R,"In page link #"+n+" not found")}(c(9));break;case"reset":h(z);break;case"init":t(),x("initCallback",z.iframe);break;default:t()}var e}())):a(R,"Ignored: "+M)}function d(e,n,i){var t=null,o=null;if(L[e]){if("function"!=typeof(t=L[e][n]))throw new TypeError(n+" on iFrame["+e+"] is not a function");o=t(i)}return o}function f(e){var n=e.id;delete L[n]}function l(e){var n=e.id;r(n,"Removing iFrame: "+n);try{e.parentNode&&e.parentNode.removeChild(e)}catch(e){}d(n,"closedCallback",n),r(n,"--"),f(e)}function m(n){null===S&&r(n,"Get page position: "+(S={x:window.pageXOffset!==e?window.pageXOffset:document.documentElement.scrollLeft,y:window.pageYOffset!==e?window.pageYOffset:document.documentElement.scrollTop}).x+","+S.y)}function g(e){null!==S&&(window.scrollTo(S.x,S.y),r(e,"Set page position: "+S.x+","+S.y),w())}function w(){S=null}function h(e){r(e.id,"Size reset requested by "+("init"===e.type?"host page":"iFrame")),m(e.id),b(function(){p(e),y("reset","reset",e.iframe,e.id)},e,"reset")}function p(e){function n(n){e.id?(e.iframe.style[n]=e[n]+"px",r(e.id,"IFrame ("+o+") "+n+" set to "+e[n]+"px")):r("undefined","messageData id not set")}function i(n){T||"0"!==e[n]||(T=!0,r(o,"Hidden iFrame detected, creating visibility listener"),function(){function e(){function e(e){function n(n){return"0px"===(L[e]&&L[e].iframe.style[n])}L[e]&&function(e){return null!==e.offsetParent}(L[e].iframe)&&(n("height")||n("width"))&&y("Visibility change","resize",L[e].iframe,e)}for(var n in L)e(n)}function n(n){r("window","Mutation observed: "+n[0].target+" "+n[0].type),F(e,16)}var i=window.MutationObserver||window.WebKitMutationObserver;i&&function(){var e=document.querySelector("body");new i(n).observe(e,{attributes:!0,attributeOldValue:!1,characterData:!0,characterDataOldValue:!1,childList:!0,subtree:!0})}()}())}function t(e){n(e),i(e)}var o=e.iframe.id;L[o]&&(L[o].sizeHeight&&t("height"),L[o].sizeWidth&&t("width"))}function b(e,n,i){i!==n.type&&H?(r(n.id,"Requesting animation frame"),H(e)):e()}function y(e,n,i,t,o){var a=!1;t=t||i.id,L[t]&&(function(){var o;i&&"contentWindow"in i&&null!==i.contentWindow?(o=L[t]&&L[t].targetOrigin,r(t,"["+e+"] Sending msg to iframe["+t+"] ("+n+") targetOrigin: "+o),i.contentWindow.postMessage(W+n,o)):s(t,"["+e+"] IFrame("+t+") not found")}(),o&&L[t]&&L[t].warningTimeout&&(L[t].msgTimeout=setTimeout(function(){!L[t]||L[t].loaded||a||(a=!0,s(t,"IFrame has not responded within "+L[t].warningTimeout/1e3+" seconds. Check iFrameResizer.contentWindow.js has been loaded in iFrame. This message can be ignored if everything is working, or you can set the warningTimeout option to a higher value or zero to suppress this warning."))},L[t].warningTimeout)))}function v(e){return e+":"+L[e].bodyMarginV1+":"+L[e].sizeWidth+":"+L[e].log+":"+L[e].interval+":"+L[e].enablePublicMethods+":"+L[e].autoResize+":"+L[e].bodyMargin+":"+L[e].heightCalculationMethod+":"+L[e].bodyBackground+":"+L[e].bodyPadding+":"+L[e].tolerance+":"+L[e].inPageLinks+":"+L[e].resizeFrom+":"+L[e].widthCalculationMethod}function k(i,t){var o=function(e){return e,""===e&&(i.id=e=function(){var e=t&&t.id||q.id+E++;return null!==document.getElementById(e)&&(e+=E++),e}(),O=(t||{}).log,e,r(e,"Added missing iframe ID: "+e+" ("+i.src+")")),e}(i.id);o in L&&"iFrameResizer"in i?s(o,"Ignored iFrame, already setup."):(function(e){e=e||{},L[o]={firstRun:!0,iframe:i,remoteHost:i.src.split("/").slice(0,3).join("/")},function(e){if("object"!=typeof e)throw new TypeError("Options is not an object")}(e),function(e){for(var n in q)q.hasOwnProperty(n)&&(L[o][n]=e.hasOwnProperty(n)?e[n]:q[n])}(e),L[o]&&(L[o].targetOrigin=!0===L[o].checkOrigin?function(e){return""===e||"file://"===e?"*":e}(L[o].remoteHost):"*")}(t),function(){switch(r(o,"IFrame scrolling "+(L[o]&&L[o].scrolling?"enabled":"disabled")+" for "+o),i.style.overflow=!1===(L[o]&&L[o].scrolling)?"hidden":"auto",L[o]&&L[o].scrolling){case"omit":break;case!0:i.scrolling="yes";break;case!1:i.scrolling="no";break;default:i.scrolling=L[o]?L[o].scrolling:"no"}}(),function(){function e(e){1/0!==L[o][e]&&0!==L[o][e]&&(i.style[e]=L[o][e]+"px",r(o,"Set "+e+" = "+L[o][e]+"px"))}function n(e){if(L[o]["min"+e]>L[o]["max"+e])throw new Error("Value for min"+e+" can not be greater than max"+e)}n("Height"),n("Width"),e("maxHeight"),e("minHeight"),e("maxWidth"),e("minWidth")}(),"number"!=typeof(L[o]&&L[o].bodyMargin)&&"0"!==(L[o]&&L[o].bodyMargin)||(L[o].bodyMarginV1=L[o].bodyMargin,L[o].bodyMargin=L[o].bodyMargin+"px"),function(t){n(i,"load",function(){y("iFrame.onload",t,i,e,!0),function(){var e=L[o]&&L[o].firstRun,n=L[o]&&L[o].heightCalculationMethod in A;!e&&n&&h({iframe:i,height:0,width:0,type:"init"})}()}),y("init",t,i,e,!0)}(v(o)),Function.prototype.bind&&L[o]&&(L[o].iframe.iFrameResizer={close:l.bind(null,L[o].iframe),removeListeners:f.bind(null,L[o].iframe),resize:y.bind(null,"Window resize","resize",L[o].iframe),moveToAnchor:function(e){y("Move to anchor","moveToAnchor:"+e,L[o].iframe,o)},sendMessage:function(e){y("Send Message","message:"+(e=JSON.stringify(e)),L[o].iframe,o)}}))}function F(e,n){null===j&&(j=setTimeout(function(){j=null,e()},n))}function I(e,n,i){B[i]||(B[i]=setTimeout(function(){B[i]=null,e()},n))}function x(e){r("window","Trigger event: "+e),F(function(){z("Window "+e,"resize")},16)}function M(){"hidden"!==document.visibilityState&&(r("document","Trigger event: Visiblity change"),F(function(){z("Tab Visable","resize")},16))}function z(e,n){function i(e){return L[e]&&"parent"===L[e].resizeFrom&&L[e].autoResize&&!L[e].firstRun}for(var t in L)i(t)&&y(e,n,document.getElementById(t),t)}function R(){n(window,"message",u),n(window,"resize",function(){x("resize")}),n(document,"visibilitychange",M),n(document,"-webkit-visibilitychange",M),n(window,"focusin",function(){x("focus")}),n(window,"focus",function(){x("focus")})}function C(){function n(e,n){n&&(function(){if(!n.tagName)throw new TypeError("Object is not a valid DOM element");if("IFRAME"!==n.tagName.toUpperCase())throw new TypeError("Expected <IFRAME> tag, found <"+n.tagName+">")}(),k(n,e),i.push(n))}var i;return function(){var e,n=["moz","webkit","o","ms"];for(e=0;e<n.length&&!H;e+=1)H=window[n[e]+"RequestAnimationFrame"];H||r("setup","RequestAnimationFrame not supported")}(),R(),function(t,o){switch(i=[],function(e){e&&e.enablePublicMethods&&s("enablePublicMethods option has been removed, public methods are now always available in the iFrame")}(t),typeof o){case"undefined":case"string":Array.prototype.forEach.call(document.querySelectorAll(o||"iframe"),n.bind(e,t));break;case"object":n(t,o);break;default:throw new TypeError("Unexpected data type ("+typeof o+")")}return i}}if("undefined"!=typeof window){var E=0,O=!1,T=!1,N="message".length,W="[iFrameSizer]",P=W.length,S=null,H=window.requestAnimationFrame,A={max:1,scroll:1,bodyScroll:1,documentElementScroll:1},L={},j=null,q={autoResize:!0,bodyBackground:null,bodyMargin:null,bodyMarginV1:8,bodyPadding:null,checkOrigin:!0,inPageLinks:!1,enablePublicMethods:!0,heightCalculationMethod:"bodyOffset",id:"iFrameResizer",interval:32,log:!1,maxHeight:1/0,maxWidth:1/0,minHeight:0,minWidth:0,resizeFrom:"parent",scrolling:!1,sizeHeight:!0,sizeWidth:!1,warningTimeout:5e3,tolerance:0,widthCalculationMethod:"scroll",closedCallback:function(){},initCallback:function(){},messageCallback:function(){s("MessageCallback function not defined")},resizedCallback:function(){},scrollCallback:function(){return!0}},B={};window.jQuery&&function(e){e.fn?e.fn.iFrameResize||(e.fn.iFrameResize=function(e){return this.filter("iframe").each(function(n,i){k(i,e)}).end()}):a("","Unable to bind to jQuery, it is not fully loaded.")}(window.jQuery),"function"==typeof define&&define.amd?define([],C):"object"==typeof module&&"object"==typeof module.exports?module.exports=C():window.iFrameResize=window.iFrameResize||C()}}();