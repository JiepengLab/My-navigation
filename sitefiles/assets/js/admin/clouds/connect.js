var $url="/clouds/connect",data=utils.init({redirect:utils.getQueryString("redirect"),isConnect:!1,iFrameUrl:""}),methods={btnConnectClick:function(){var t=this;this.iFrameUrl=cloud.host+"/auth.html",this.isConnect=!0,window.addEventListener("message",function(i){if(i.origin===cloud.host){var e=i.data.userId,n=i.data.userName,a=i.data.mobile,o=i.data.token;e&&n&&o&&t.apiSubmit(e,n,a,o)}},!1)},apiGet:function(){var t=this;utils.loading(this,!0),$api.get($url).then(function(i){var e=i.data;e.userName&&e.token&&(cloud.login(e.userName,e.token),location.href=t.redirect)}).catch(function(t){utils.error(t)}).then(function(){utils.loading(t,!1)})},apiSubmit:function(t,i,e,n){var a=this;utils.loading(this,!0),$api.post($url,{userId:t,userName:i,mobile:e,token:n}).then(function(t){t.data.value&&(cloud.login(i,n),location.href=a.redirect)}).catch(function(t){utils.error(t)}).then(function(){utils.loading(a,!1)})},btnCloseClick:function(){utils.removeTab()}},$vue=new Vue({el:"#main",data:data,methods:methods,created:function(){utils.keyPress(null,this.btnCloseClick),utils.loading(this,!1)}});