var $url="/settings/administratorsLayerPassword",data=utils.init({userName:utils.getQueryString("userName"),isEnforcePasswordChange:utils.getQueryBoolean("isEnforcePasswordChange"),administrator:null,form:{password:null,confirmPassword:null}}),methods={apiGet:function(){var t=this;$api.get($url,{params:{userName:this.userName}}).then(function(s){var i=s.data;t.administrator=i.administrator,t.userName||t.$message({type:"warning",message:"您的密码已过期，请更改登录密码",showClose:!0,duration:0})}).catch(function(t){utils.error(t)}).then(function(){utils.loading(t,!1)})},toBase64:function(t){var s=(new TextEncoder).encode(t),i=Array.from(s,function(t){return String.fromCodePoint(t)}).join("");return btoa(i)},apiSubmit:function(){var t=this;utils.loading(this,!0),$api.post($url,{userName:this.userName,password:this.form.password?this.toBase64(this.form.password):""}).then(function(s){s.data;utils.success("密码更改成功！"),setTimeout(function(){t.isEnforcePasswordChange?window.top.location=utils.getIndexUrl():utils.closeLayer()},1e3)}).catch(function(t){utils.error(t)}).then(function(){utils.loading(t,!1)})},validatePass:function(t,s,i){""===s?i(new Error("请再次输入密码")):s!==this.form.password?i(new Error("两次输入密码不一致!")):i()},btnSubmitClick:function(){var t=this;this.$refs.form.validate(function(s){s&&t.apiSubmit()})},btnCancelClick:function(){utils.closeLayer()}},$vue=new Vue({el:"#main",data:data,methods:methods,created:function(){utils.keyPress(this.btnSubmitClick,this.btnCancelClick),this.apiGet()}});