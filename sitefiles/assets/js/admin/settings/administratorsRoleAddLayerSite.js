var data=utils.init({roleId:utils.getQueryInt("roleId"),siteId:utils.getQueryInt("siteId"),isSite:!1,site:null,permissionInfo:null,treeData:[],defaultExpandedKeys:[]}),methods={getPermissionInfo:function(s){for(var e=s.sitePermissions||[],i=[],n=[],t=0;t<e.length;t++)n.push(e[t].name),e[t].selected&&i.push(e[t].name);var o=s.contentPermissions||[],r=[],h=[];for(t=0;t<o.length;t++)h.push(o[t].name),o[t].selected&&r.push(o[t].name);var m=s.channel,c=s.checkedChannelIds||[];return{siteId:this.siteId,sitePermissions:e,siteCheckAll:!1,isSiteIndeterminate:!0,allSitePermissions:n,checkedSitePermissions:i,contentPermissions:o,contentCheckAll:!1,isContentIndeterminate:!0,allContentPermissions:h,checkedContentPermissions:r,channel:m,checkedChannelIds:c}},handleSiteCheckAllChange:function(s){if(this.permissionInfo.checkedSitePermissions=[],s)for(var e=0;e<this.permissionInfo.sitePermissions.length;e++)this.permissionInfo.checkedSitePermissions.push(this.permissionInfo.sitePermissions[e].name);this.permissionInfo.isSiteIndeterminate=!1},handleCheckedSitePermissionsChange:function(s){var e=s.length;this.permissionInfo.siteCheckAll=e===this.permissionInfo.sitePermissions.length,this.permissionInfo.isSiteIndeterminate=e>0&&e<this.permissionInfo.sitePermissions.length},getSitePermissionText:function(s){for(var e=0;e<this.permissionInfo.sitePermissions.length;e++)if(this.permissionInfo.sitePermissions[e].name===s)return this.permissionInfo.sitePermissions[e].text;return""},handleContentCheckAllChange:function(s){if(this.permissionInfo.checkedContentPermissions=[],s)for(var e=0;e<this.permissionInfo.contentPermissions.length;e++)this.permissionInfo.checkedContentPermissions.push(this.permissionInfo.contentPermissions[e].name);this.permissionInfo.isContentIndeterminate=!1},handleTreeChanged:function(){this.permissionInfo.checkedChannelIds=this.$refs.tree.getCheckedKeys()},handleCheckedContentPermissionsChange:function(s){var e=s.length;this.permissionInfo.contentCheckAll=e===this.permissionInfo.contentPermissions.length,this.permissionInfo.isContentIndeterminate=e>0&&e<this.permissionInfo.contentPermissions.length},getContentPermissionText:function(s){for(var e=0;e<this.permissionInfo.contentPermissions.length;e++)if(this.permissionInfo.contentPermissions[e].name===s)return this.permissionInfo.contentPermissions[e].text;return""},setValues:function(s,e){this.site=s.site,this.permissionInfo=this.getPermissionInfo(s),this.treeData=[this.permissionInfo.channel],this.defaultExpandedKeys=[this.permissionInfo.channel.id],utils.loading(this,!1),this.isSite=!!e,this.isSite&&(this.permissionInfo.checkedChannelIds=e.channelIds,this.permissionInfo.checkedSitePermissions=e.permissions,this.permissionInfo.checkedContentPermissions=e.contentPermissions)},btnSubmitClick:function(){for(var s=[],e=0;e<parent.$vue.sitePermissions.length;e++)parent.$vue.sitePermissions[e].siteId!=this.siteId&&s.push(parent.$vue.sitePermissions[e]);this.isSite&&s.push({siteId:this.siteId,channelIds:this.permissionInfo.checkedChannelIds,permissions:_.union(this.permissionInfo.checkedSitePermissions),contentPermissions:this.permissionInfo.checkedContentPermissions}),parent.$vue.sitePermissions=s,utils.closeLayer()},btnCancelClick:function(){utils.closeLayer()}},$vue=new Vue({el:"#main",data:data,methods:methods,created:function(){utils.keyPress(this.btnSubmitClick,this.btnCancelClick)}});