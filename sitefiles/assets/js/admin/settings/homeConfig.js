var $url="/settings/homeConfig",data=utils.init({config:null,uploadUrl:null,uploadFileListHomeLogoUrl:[],uploadFileListHomeDefaultAvatarUrl:[],uploadType:null,homeDirectory:null,form:{uploadLogoUrl:null,isHomeClosed:null,homeTitle:null,isHomeLogo:null,homeLogoUrl:null,homeDefaultAvatarUrl:null,userRegistrationAttributes:[],isUserRegistrationMobile:null,isUserRegistrationEmail:null,isUserRegistrationGroup:null,isUserRegistrationDisplayName:null,isHomeAgreement:null,homeAgreementHtml:null,homeWelcomeHtml:null,styles:null}}),methods={apiGet:function(){var e=this;utils.loading(this,!0),$api.get($url).then(function(o){var t=o.data;e.config=t.config,e.homeDirectory=t.homeDirectory,e.form.isHomeClosed=t.config.isHomeClosed,e.form.homeTitle=t.config.homeTitle,e.form.isHomeLogo=t.config.isHomeLogo,e.form.homeLogoUrl=t.config.homeLogoUrl,e.form.homeDefaultAvatarUrl=t.config.homeDefaultAvatarUrl,e.form.userRegistrationAttributes=t.config.userRegistrationAttributes||[],e.form.isUserRegistrationMobile=t.config.isUserRegistrationMobile,e.form.isUserRegistrationEmail=t.config.isUserRegistrationEmail,e.form.isUserRegistrationGroup=t.config.isUserRegistrationGroup,e.form.isUserRegistrationDisplayName=t.config.isUserRegistrationDisplayName,e.form.isHomeAgreement=t.config.isHomeAgreement,e.form.homeAgreementHtml=t.config.homeAgreementHtml,e.form.homeWelcomeHtml=t.homeWelcomeHtml||"欢迎使用用户中心",e.styles=t.styles,e.form.homeLogoUrl&&e.uploadFileListHomeLogoUrl.push({name:"avatar",url:e.form.homeLogoUrl}),e.form.homeDefaultAvatarUrl&&e.uploadFileListHomeDefaultAvatarUrl.push({name:"avatar",url:e.form.homeDefaultAvatarUrl})}).catch(function(e){utils.error(e)}).then(function(){utils.loading(e,!1)})},apiSubmit:function(){var e=this;utils.loading(this,!0),$api.post($url,{isHomeClosed:this.form.isHomeClosed,homeTitle:this.form.homeTitle,isHomeLogo:this.form.isHomeLogo,homeLogoUrl:this.form.homeLogoUrl,homeDefaultAvatarUrl:this.form.homeDefaultAvatarUrl,userRegistrationAttributes:this.form.userRegistrationAttributes,isUserRegistrationMobile:this.form.isUserRegistrationMobile,isUserRegistrationEmail:this.form.isUserRegistrationEmail,isUserRegistrationGroup:this.form.isUserRegistrationGroup,isUserRegistrationDisplayName:this.form.isUserRegistrationDisplayName,isHomeAgreement:this.form.isHomeAgreement,homeAgreementHtml:this.form.homeAgreementHtml,homeWelcomeHtml:this.form.homeWelcomeHtml}).then(function(e){e.data;utils.success("用户中心设置保存成功！")}).catch(function(e){utils.error(e)}).then(function(){utils.loading(e,!1)})},getUserRegistrationAttribute:function(e){return e},btnUsersStyleClick:function(){utils.addTab("用户字段",utils.getSettingsUrl("usersStyle"))},btnSubmitClick:function(){var e=this;this.$refs.form.validate(function(o){o&&e.apiSubmit()})},uploadBeforeHomeLogoUrl(e){return this.uploadType="homeLogoUrl",this.uploadBefore(e)},uploadBeforeHomeDefaultAvatarUrl(e){return this.uploadType="homeDefaultAvatarUrl",this.uploadBefore(e)},uploadBefore:e=>/(\.jpg|\.jpeg|\.bmp|\.gif|\.png|\.webp)$/i.exec(e.name)?!!(e.size/1024/1024<10)||(utils.error("管理后台Logo图片大小不能超过 10MB!"),!1):(utils.error("管理后台Logo只能是图片格式，请选择有效的文件上传!"),!1),uploadProgress:function(){utils.loading(this,!0)},uploadSuccess:function(e,o,t){"homeLogoUrl"===this.uploadType?this.form.homeLogoUrl=e.value:"homeDefaultAvatarUrl"===this.uploadType&&(this.form.homeDefaultAvatarUrl=e.value),utils.loading(this,!1),t.length>1&&t.splice(0,1)},uploadError:function(e){utils.loading(this,!1);var o=JSON.parse(e.message);utils.error(o.message)},uploadRemoveHomeLogoUrl(e){this.form.homeLogoUrl=null},uploadRemoveHomeDefaultAvatarUrl(e){this.form.homeDefaultAvatarUrl=null},btnCloseClick:function(){utils.removeTab()}},$vue=new Vue({el:"#main",data:data,methods:methods,created:function(){utils.keyPress(this.btnSubmitClick,this.btnCloseClick),this.uploadUrl=$apiUrl+$url+"/actions/upload",this.apiGet()}});