var $url="/common/material/layerVideoSelect",data=utils.init({siteId:utils.getQueryInt("siteId"),inputType:utils.getQueryString("inputType"),attributeName:utils.getQueryString("attributeName"),no:utils.getQueryInt("no"),isSiteOnly:!1,groups:null,count:null,items:null,isCloudVod:null,urlList:null,renameId:0,renameTitle:"",deleteId:0,selectedGroupId:0,form:{siteId:utils.getQueryInt("siteId"),keyword:"",groupId:0,page:1,perPage:24}}),methods={insert:function(t){"Video"===this.inputType?parent.$vue.runMaterialLayerVideoSelect&&parent.$vue.runMaterialLayerVideoSelect(this.attributeName,this.no,t):"TextEditor"===this.inputType&&parent.$vue.insertEditor(this.attributeName,'<img src="/sitefiles/assets/images/video-clip.png" style="width: 333px; height: 333px" playUrl="'+t+'" class="siteserver-stl-player" /><br/>')},apiList:function(t){var i=this;this.form.page=t,utils.loading(this,!0),$api.get($url,{params:this.form}).then(function(t){var e=t.data;e.isCloudVod&&(location.href=utils.getCloudsUrl("layerVodSelect",{inputType:i.inputType,attributeName:i.attributeName,no:i.no})),i.isSiteOnly=e.isSiteOnly,i.isSiteOnly&&(i.form.groupId=-i.siteId),i.groups=e.groups,i.count=e.count,i.items=e.items,i.urlList=_.map(i.items,function(t){return t.fileUrl})}).catch(function(t){utils.error(t)}).then(function(){utils.loading(i,!1)})},getGroupName:function(){var t=this;return this.form.groupId>0?_.find(this.groups,function(i){return i.id===t.form.groupId}).groupName:""},btnSelectClick:function(t){var i=this;utils.loading(this,!0),$api.post($url+"/actions/select",{siteId:this.siteId,materialId:t.id}).then(function(t){var e=t.data;i.insert(e.value),utils.closeLayer()}).catch(function(t){utils.error(t)}).then(function(){utils.loading(i,!1)})},btnSelectGroupClick:function(t){this.selectedGroupId=this.selectedGroupId===t?0:t},btnGroupClick:function(t){var i=this;this.form.groupId=t,this.form.page=1,utils.loading(this,!0),$api.get($url,{params:this.form}).then(function(t){var e=t.data;i.groups=e.groups,i.count=e.count,i.items=e.items,i.urlList=_.map(i.items,function(t){return t.fileUrl})}).catch(function(t){i.$notify.error({title:"错误",message:t.message})}).then(function(){utils.loading(i,!1)})},btnSearchClick(){utils.loading(this,!0),this.apiList(1)},btnPageClick:function(t){utils.loading(this,!0),this.apiList(t)},btnCancelClick:function(){utils.closeLayer()}},$vue=new Vue({el:"#main",data:data,methods:methods,created:function(){utils.keyPress(null,this.btnCancelClick),this.apiList(1)}});