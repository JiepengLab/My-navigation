var $url="/cms/forms/formListLayerAdd",$urlUpdate=$url+"/actions/update",data=utils.init({siteId:utils.getQueryInt("siteId"),formId:utils.getQueryInt("formId"),form:{title:null,description:null}}),methods={apiGet:function(){var t=this;utils.loading(this,!0),$api.get($url,{params:{siteId:this.siteId,formId:this.formId}}).then(function(i){var s=i.data;t.form=s.form}).catch(function(t){utils.error(t)}).then(function(){utils.loading(t,!1)})},apiAdd:function(){var t=this;utils.loading(this,!0),$api.post($url,{siteId:this.siteId,title:this.form.title,description:this.form.description}).then(function(t){t.data;utils.alertSuccess({title:"表单添加成功",text:"表单添加成功，系统需要重载页面",callback:function(){window.top.location.reload(!0)}})}).catch(function(t){utils.error(t)}).then(function(){utils.loading(t,!1)})},apiEdit:function(){var t=this;utils.loading(this,!0),$api.post($urlUpdate,{siteId:this.siteId,formId:this.form.id,title:this.form.title,description:this.form.description}).then(function(t){if(!t.data.value)return utils.error("表单修改失败，已存在同名表单，请修改表单名称！");utils.alertSuccess({title:"表单修改成功",text:"表单修改成功，系统需要重载页面",callback:function(){window.top.location.reload(!0)}})}).catch(function(t){utils.error(t)}).then(function(){utils.loading(t,!1)})},btnSubmitClick:function(){var t=this;this.$refs.form.validate(function(i){i&&(t.form.id?t.apiEdit():t.apiAdd())})},btnCancelClick:function(){utils.closeLayer(!1)}},$vue=new Vue({el:"#main",data:data,methods:methods,created:function(){utils.keyPress(this.btnSubmitClick,this.btnCancelClick),this.formId?this.apiGet():utils.loading(this,!1),utils.focus(this,"title")}});