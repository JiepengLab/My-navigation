var $url="/cms/contents/contentsReplace",data=utils.init({siteId:utils.getQueryInt("siteId"),checkedChannelIds:[],channels:null,expandedChannelIds:[],filterText:"",attributes:null,channelIds:[],form:{attributeNames:[],replace:"",isCaseSensitive:!0,isRegex:!1,isDescendant:!1,to:""}}),methods={apiGet:function(){var t=this;utils.loading(this,!0),$api.get($url,{params:{siteId:this.siteId}}).then(function(e){var i=e.data;t.channels=[i.channels],t.expandedChannelIds=_.union([t.siteId],t.checkedChannelIds),t.attributes=i.attributes}).catch(function(t){utils.error(t)}).then(function(){utils.loading(t,!1)})},apiSubmit:function(t){var e=this;utils.loading(this,!0),$api.post($url,t).then(function(t){t.data;utils.success("批量替换成功！")}).catch(function(t){utils.error(t)}).then(function(){utils.loading(e,!1)})},getChannelUrl:function(t){return utils.getRootUrl("redirect",{siteId:this.siteId,channelId:t.value})},filterNode:function(t,e){return!t||(-1!==e.label.indexOf(t)||e.value+""===t)},handleCheckChange(){this.channelIds=this.$refs.tree.getCheckedKeys()},btnReplaceClick:function(){this.form.attributeNames=[];for(var t=0;t<this.attributes.length;t++){var e=this.attributes[t];e.selected&&this.form.attributeNames.push(e.value)}if(0!==this.form.attributeNames.length){var i=this;this.$refs.form.validate(function(t){t&&utils.alertDelete({title:"批量替换",text:"此操作将批量替换对应文字且无法恢复，确定吗？",button:"批量替换",callback:function(){i.apiSubmit({siteId:i.siteId,channelIds:i.channelIds,attributeNames:i.form.attributeNames,replace:i.form.replace,isCaseSensitive:i.form.isCaseSensitive,isRegex:i.form.isRegex,isDescendant:i.form.isDescendant,to:i.form.to})}})})}else utils.error("请选择需要替换的字段！")},btnCloseClick:function(){utils.removeTab()}},$vue=new Vue({el:"#main",data:data,methods:methods,watch:{filterText:function(t){this.$refs.tree.filter(t)}},created:function(){utils.keyPress(this.btnReplaceClick,this.btnCloseClick),this.apiGet()}});