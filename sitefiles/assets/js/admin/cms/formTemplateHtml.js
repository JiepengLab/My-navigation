var $url="/cms/forms/formTemplateHtml",data=utils.init({siteId:utils.getQueryInt("siteId"),isSystem:utils.getQueryBoolean("isSystem"),name:utils.getQueryString("name"),templateHtml:null,contentEditor:null}),methods={apiGet:function(){var t=this;utils.loading(this,!0),$api.get($url,{params:{siteId:this.siteId,isSystem:this.isSystem,name:this.name}}).then(function(e){var i=e.data;t.templateHtml=i.templateHtml,setTimeout(function(){$("#templateContent").height($(document).height()-80),require.config({paths:{vs:utils.getAssetsUrl("lib/monaco-editor/min/vs")}}),require(["vs/editor/editor.main"],function(){t.contentEditor=monaco.editor.create(document.getElementById("templateContent"),{value:t.templateHtml,language:"html"}),t.contentEditor.focus()})},100)}).catch(function(t){utils.error(t)}).then(function(){utils.loading(t,!1)})},apiSubmit:function(t){var e=this;utils.loading(this,!0),$api.post($url,{siteId:this.siteId,name:this.name,templateHtml:this.templateHtml}).then(function(e){e.data;utils.success("模板编辑成功！"),t&&utils.removeTab()}).catch(function(t){utils.error(t)}).then(function(){utils.loading(e,!1)})},getEditorContent:function(){return this.contentEditor.getModel().getValue()},btnSubmitClick:function(t){this.isSystem?utils.openLayer({title:"克隆模板",url:utils.getCmsUrl("formTemplatesLayerEdit",{siteId:this.siteId,isSystem:this.isSystem,name:this.name,isClone:!0,isHtml:!0}),width:500,height:300}):(this.templateHtml=this.getEditorContent(),this.apiSubmit(t))},btnCloseClick:function(){utils.removeTab()}},$vue=new Vue({el:"#main",data:data,methods:methods,created:function(){utils.keyPress(this.btnSubmitClick,this.btnCloseClick),this.apiGet()}});