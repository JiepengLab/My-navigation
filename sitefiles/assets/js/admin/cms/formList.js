var $url="/cms/forms/formList",$urlOrder=$url+"/actions/order",$urlExport=$url+"/actions/export",$urlImport=$url+"/actions/import",$urlDelete=$url+"/actions/delete",data=utils.init({siteId:utils.getQueryInt("siteId"),pageType:"list",forms:null,authFormIds:null,form:null,urlUpload:null,files:[]}),methods={apiGet:function(){var t=this;utils.loading(this,!0),$api.get($url,{params:{siteId:this.siteId}}).then(function(i){var e=i.data;t.forms=e.forms,t.authFormIds=e.authFormIds}).catch(function(t){utils.error(t)}).then(function(){utils.loading(t,!1)})},apiDelete:function(t){var i=this;utils.loading(this,!0),$api.post($urlDelete,{siteId:this.siteId,formId:t}).then(function(t){t.data;utils.alertSuccess({title:"表单删除成功",text:"表单删除成功，系统需要重载页面",callback:function(){window.top.location.reload(!0)}})}).catch(function(t){utils.error(t)}).then(function(){utils.loading(i,!1)})},btnViewClick:function(t){utils.addTab(t.title,utils.getCmsUrl("formData",{siteId:this.siteId,formId:t.id}))},isDisabled:function(t){return-1===this.authFormIds.indexOf(t.id)},onSort:function(t){var i=this.forms[t.oldIndex].id,e=t.oldIndex>t.newIndex,l=Math.abs(t.oldIndex-t.newIndex);this.btnOrderClick(i,e,l)},btnOrderClick:function(t,i,e){var l=this;utils.loading(this,!0),$api.post($urlOrder,{siteId:this.siteId,formId:t,isUp:i,rows:e}).then(function(t){var i=t.data;l.forms=i.forms,utils.success("表单排序成功！")}).catch(function(t){utils.error(t)}).then(function(){utils.loading(l,!1)})},btnEditClick:function(t){utils.openLayer({title:"修改表单",url:utils.getCmsUrl("formListLayerAdd",{siteId:this.siteId,formId:t.id}),width:550,height:450})},btnAddClick:function(){utils.openLayer({title:"新增表单",url:utils.getCmsUrl("formListLayerAdd",{siteId:this.siteId}),width:550,height:450})},btnDeleteClick:function(t){var i=this;utils.alertDelete({title:"删除表单",text:"此操作将删除表单"+t.title+"，确定吗？",callback:function(){i.apiDelete(t.id)}})},btnExportClick:function(t){var i=this;utils.loading(this,!0),$api.post($urlExport,{siteId:this.siteId,formId:t.id}).then(function(t){var i=t.data;window.open(i.value)}).catch(function(t){utils.error(t)}).then(function(){utils.loading(i,!1)})},uploadBefore:t=>!!/(\.zip)$/i.exec(t.name)||(utils.error("上传格式错误，请上传zip压缩包!"),!1),uploadProgress:function(){utils.loading(this,!0)},uploadSuccess:function(t,i){utils.loading(this,!1),utils.alertSuccess({title:"表单导入成功",text:"表单导入成功，系统需要重载页面",callback:function(){window.top.location.reload(!0)}})},uploadError:function(t){utils.loading(this,!1);var i=JSON.parse(t.message);utils.error(i.message)},btnCloseClick:function(){utils.removeTab()}},$vue=new Vue({el:"#main",components:{ElTableDraggable:ElTableDraggable},data:data,methods:methods,created:function(){utils.keyPress(null,this.btnCloseClick),this.apiGet(),this.urlUpload=$apiUrl+$urlImport+"?siteId="+this.siteId}});