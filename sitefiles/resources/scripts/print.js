var forSPrint=new Object;forSPrint.data={artiBodyId:"artibody",titleId:"artibodyTitle",pageLogoId:"pagelogo",pageWayId:"lo_links",pageLogoHtml:"",titleHtml:"",artiBodyHtml:"",pageWayHtml:"",iconUrl:"/sitefiles/assets/print",curPageNum:1,pageUrl:new Array},forSPrint.GetPageInitInfo=function(){var t,n,i=new Array,e=new Array;if((e[0]=window.location.href,n=1,null!=document.getElementById("_function_code_page"))&&(t=/��(<a href=\".*?\">){0,1}\[\d+\](<\/a>){0,1}/gi,i=document.getElementById("_function_code_page").innerHTML.match(t)))for(var r=0;r<i.length;r++){new RegExp('<a href="(.*?)">[[0-9]+]</a>',"i").exec(i[r])?e[r]=RegExp.$1:(e[r]=window.location.href,n=r+1)}forSPrint.data.pageUrl=e,forSPrint.data.curPageNum=n,""!=forSPrint.data.pageWayId&&null!=document.getElementById(forSPrint.data.pageWayId)&&(forSPrint.data.pageWayHtml=document.getElementById(forSPrint.data.pageWayId).innerHTML),""!=forSPrint.data.titleId&&null!=document.getElementById(forSPrint.data.titleId)&&(forSPrint.data.titleHtml=document.getElementById(forSPrint.data.titleId).innerHTML),""!=forSPrint.data.artiBodyId&&null!=document.getElementById(forSPrint.data.artiBodyId)&&(forSPrint.data.artiBodyHtml=document.getElementById(forSPrint.data.artiBodyId).innerHTML),""!=forSPrint.data.pageLogoId&&null!=document.getElementById(forSPrint.data.pageLogoId)&&(forSPrint.data.pageLogoHtml=document.getElementById(forSPrint.data.pageLogoId).innerHTML)},forSPrint.Print=function(){forSPrint.GetPageInitInfo();var t='<html>\n<head>\n<meta http-equiv="Content-Type" content="text/html; charset=gb2312" />\n<title></title>\n<meta name="Keywords" content="," />\n<meta name="Description" content="" />\n<style type="text/css" media="screen">\n*{margin:0;padding:0; font-family:"����";}\nbody {background: #FFF;color:#000; font-size:12px;}\nul,li{list-style:none;}\nul,p,ol{line-height:20px;}\nselect,input{vertical-align:middle;}\nimg{border:0;}\n.f12{font-size:12px; line-height:20px;}\n.f14{font-size:14px;}\nh1{font-size:22px;margin: 0px;border-bottom:1px #7D8388 solid;}\n.from_info{ font-size:12px; text-align:center; color:#000;font-weight:normal}\n#PriCon{font-size:14px;width:560px; text-align:left;}\n#PriCon p{ line-height:23px;margin:15px 0;}\n#PriCon img{border:1px #000 solid;}\n#PriCon.noImg img{display:none;}\n.medialogo{float:right; height:18px;}\n.linkRed01 {text-decoration:underline;color:#000;}\n.linkRed01 a{text-decoration:underline;color:#000;}\na{text-decoration: underline;color: #000; }\na:hover{color: #f00;}\n.selFZ{padding:0 2px; background:#999; border:1px #6f6f6f solid; text-decoration:none; cursor:default; color:#fff;}\n.NselFZ{text-decoration:underlinel; cursor:pointer; padding:0 5px;\n.selFZ,.NselFZ{padding-top:2px;}\n.yqin {display:inline; height:0px; width:0px; position:absolute; text-align:left;}\n.linkRed02 a{text-decoration:none;color:#000;}\n.linkRed02 a:hover{color:#f00;}\n</style>\n\x3c!--[if IE]>\n<style type="text/css" media="screen">\n#printDialog { filter:progid:DXImageTransform.Microsoft.Alpha(opacity=100); filter:progid:DXImageTransform.Microsoft.dropshadow(OffX=3, OffY=3,Color="#e0e0e0", Positive="true");}\n</style>\n<![endif]--\x3e\n<style type="text/css" media="print">\n*{margin:0;padding:0; font-family:"����";}\nbody {background: #FFF;color:#000; font-size:12px;}\nul,li{list-style:none;}\nul,p,ol{line-height:20px;}\nselect,input{vertical-align:middle;}\nimg{border:0;}\nh1{font-size:22px;margin: 0px;border-bottom:1px #7D8388 solid;}\n.f12{font-size:12px; line-height:20px;}\n.f14{font-size:14px;}\na{text-decoration: underline;color: #000}\na:hover{color: #f00;}\n.selFZ{padding:0 2px; background:#999; border:1px #6f6f6f solid; text-decoration:none; cursor:default; color:#fff;}\n.NselFZ{text-decoration:underlinel; cursor:pointer; padding:0 5px;}\n.selFZ,.NselFZ{padding-top:2px;}\n#PriCon{font-size:14px;width:560px;text-align:left;}\n#PriCon p{line-height:23px;margin:15px 0;}\n#PriCon img{border:1px #000 solid;}\n#PriCon.noImg img{display:none;}\n.medialogo{float:right; height:18px;}\n.linkRed01 {text-decoration:underline;color:#000;}\n.linkRed01 a{text-decoration:underline;color:#000;}\n.yqin {display:inline; height:0px; width:0px; position:absolute; text-align:left;}\n.from_info{ font-size:12px; text-align:center; color:#000;font-weight:normal}\n.linkRed02 a{text-decoration:none;color:#000;}\n.linkRed02 a:hover{color:#f00;}\n#NoPrinter1,#NoPrinter2,#NoPrinter3,#NoPrinter4{display:none;}\n#printDialog { display:none; visibility:hidden;}\n#allIframe { display:none;}\n</style>\n<script language="JavaScript" type="text/javascript">\n\x3c!--//--\x3e<![CDATA[//>\x3c!--\nvar sPrint = new Object();\nsPrint.data ={\n\tartiBodyId \t: "'+forSPrint.data.artiBodyId+'",\t//ҳ������Ҫ���� node id\t\n\ttitleId    \t: "'+forSPrint.data.titleId+'",\t\t//ҳ�����ⲿ��node id\t\n\tpageLogoId \t: "'+forSPrint.data.pageLogoId+'",\t//ҳ��logo������id\n\tpageWayId\t: "'+forSPrint.data.pageWayId+'",\t\t//ҳ��·��������id\n\t\n\tpageLogoHtml: "'+escape(forSPrint.data.pageLogoHtml)+'",\t//��ʼ��ʾ��   logo html\n\ttitleHtml\t: "'+escape(forSPrint.data.titleHtml)+'",\t\t//��ʼ��ʾ�ı���html\n\tartiBodyHtml: "'+escape(forSPrint.data.artiBodyHtml)+'",\t//��ʼ��ʾ����Ҫ����html\n\tpageWayHtml : "'+escape(forSPrint.data.pageWayHtml)+'",\t//��ʼҳ��·��html\n\t\n\ticonUrl\t\t: "'+escape(forSPrint.data.iconUrl)+'",\t//icon��ַ\n\t\n\tcurPageNum \t: '+forSPrint.data.curPageNum+",\t\t\t\t//��ǰҳ��\n\t//����ҳ��url �ӵ�1ҳ��ʼ\n\tpageUrl    \t: new Array(\n",n=forSPrint.data.pageUrl.length;if(1==n)t+='\t"'+forSPrint.data.pageUrl[0]+'"\n';else{if(!(n>1))throw new Error("forSPrint.data.pageUrl.length < 1");for(var i=0;i<n-1;i++)t+='\t"'+forSPrint.data.pageUrl[i]+'",\n';t+='\t"'+forSPrint.data.pageUrl[n-1]+'"\n'}t+='\t)\n}; \n//--\x3e<!]]>\n<\/script>\n<script language="JavaScript" type="text/javascript">\n\x3c!--//--\x3e<![CDATA[//>\x3c!--\nvar flag=false;\nfunction DrawImage(ImgD){\n\tvar image=new Image();\n\tvar iwidth = 999;\n\tvar iheight = 21;\n\timage.src=ImgD.src;\n\tif(image.width>0 && image.height>0){\n\t\tflag=true;\n\t\tif(image.width/image.height>= iwidth/iheight){\n\t\t\tif(image.width>iwidth){\n\t\t\t\tImgD.width=iwidth;\n\t\t\t\tImgD.height=(image.height*iwidth)/image.width;\n\t\t\t}else{\n\t\t\t\tImgD.width=image.width;\n\t\t\t\tImgD.height=image.height;\n\t\t\t}\n\t\t}else{\n\t\t\tif(image.height>iheight){\n\t\t\t\tImgD.height=iheight;\n\t\t\t\tImgD.width=(image.width*iheight)/image.height;\n\t\t\t}else{\n\t\t\t\tImgD.width=image.width;\n\t\t\t\tImgD.height=image.height;\n\t\t\t}\n\t\t}\n\t}\n}\n//--\x3e<!]]>\n<\/script>\n</head>\n<body>\n<center>\n  <table width="600" cellspacing="0" id="NoPrinter1" style="border-bottom:1px #DDD9D3 solid;">\n    <tr align="left" valign="middle">\n      <td width="4" height="36"></td>\n      <td class="f14" style="padding-top:2px;">��ҳ��Ϊ��ӡԤ��ҳ<input name="printImgCheckbox" id="printImgCheckbox" type="checkbox" value="checkbox" checked onClick="sPrint.printImgCboxChg(this);" style="margin: 0px 2px 4px 10px;">��ӡͼƬ</td>\n      <td width="70" class="f14" style="padding-top:2px;">ѡ���ֺţ�</td>\n      <td width="115" class="f14" valign="top"><table cellspacing="0" class="f14" style="margin-top:8px;">\n          <tr align="left" valign="middle">\n            <td class="NselFZ" id="topadmenu_0" onClick="sPrint.doPriZoom(20);sPrint.ChgFz(0);" height="20">����</td>\n            <td class="NselFZ" id="topadmenu_1" onClick="sPrint.doPriZoom(16);sPrint.ChgFz(1);">��</td>\n            <td class="selFZ" id="topadmenu_2" onClick="sPrint.doPriZoom(14);sPrint.ChgFz(2);">��</td>\n            <td class="NselFZ" id="topadmenu_3" onClick="sPrint.doPriZoom(12);sPrint.ChgFz(3);">С</td>\n          </tr>\n        </table></td>\n      <td width="90"><a href="javascript:sPrint.Print();"><img src="'+forSPrint.data.iconUrl+'/print.gif" width="80" height="20" alt="��ӡ��ҳ��"/></a></td>\n      <td width="65"><a href="javascript:sPrint.GoBack()"><img src="'+forSPrint.data.iconUrl+'/return.gif" width="64" height="20" alt="��������ҳ"/></a></td>\n    </tr>\n  </table>\n  <table width="600" cellspacing="0">\n    <tr align="center">\n      <td width="1" style="background:#DDD9D3;" id="NoPrinter3"></td>\n      <td width="598" valign="top"><table width="560" cellspacing="0" style="margin-top:7px;">\n          <tr valign="top">\n            <td width="181" align="left" id="pagelogo"></td>\n            <td style="padding-top:12px; line-height:21px;" class="f12" id="lo_links"></td>\n          </tr>\n        </table>\n        <table cellspacing="0">\n          <tr>\n            <td height="34"></td>\n          </tr>\n        </table>\n        <table cellspacing="0" width="560">\n          <tr align="center">\n            <td style="font-size:22px; font-weight:bold; line-height:40px;" id="artibodyTitle"></td>\n          </tr>\n        </table>\n        <div id="PriCon"></div>\n\t\t<div id="WzLy" style="font-size:12px; margin:30px 0 40px 0; padding:0 15px; text-align:left; line-height:18px;"> ������Դ��<span id="artiPath"></span></div>\n\t  </td>\n      <td width="1" style="background:#DDD9D3;" id="NoPrinter4"></td>\n    </tr>\n  </table>\n  <table width="600" cellspacing="0" id="NoPrinter2" style="border-top:1px #DDD9D3 solid;">\n    <tr align="left" valign="middle">\n      <td width="4" height="36"></td>\n      <td class="f14" style="padding-top:2px;">��ҳ��Ϊ��ӡԤ��ҳ<input name="printImgCheckbox2" id="printImgCheckbox2" type="checkbox" value="checkbox" checked onClick="sPrint.printImgCboxChg(this);" style="margin: 0px 2px 4px 10px;">��ӡͼƬ</td>\n      <td width="70" class="f14" style="padding-top:2px;">ѡ���ֺţ�</td>\n      <td width="115" class="f14" valign="top"><table cellspacing="0" class="f14" style="margin-top:8px;">\n          <tr align="left" valign="middle">\n            <td class="NselFZ" id="topadmenu2_0" onClick="sPrint.doPriZoom(20);sPrint.ChgFz2(0);" height="20">����</td>\n            <td class="NselFZ" id="topadmenu2_1" onClick="sPrint.doPriZoom(16);sPrint.ChgFz2(1);">��</td>\n            <td class="selFZ" id="topadmenu2_2" onClick="sPrint.doPriZoom(14);sPrint.ChgFz2(2);">��</td>\n            <td class="NselFZ" id="topadmenu2_3" onClick="sPrint.doPriZoom(12);sPrint.ChgFz2(3);">С</td>\n          </tr>\n        </table></td>\n      <td width="90"><a href="javascript:sPrint.Print();"><img src="'+forSPrint.data.iconUrl+'/print.gif" width="80" height="20" alt="��ӡ��ҳ��"/></a></td>\n      <td width="65"><a href="javascript:sPrint.GoBack()"><img src="'+forSPrint.data.iconUrl+'/return.gif" width="64" height="20" alt="��������ҳ"/></a></td>\n    </tr>\n  </table>\n</center>\n\x3c!-- print dialog start --\x3e\n<div id="printDialog" style="width:250px; display:none; text-align:center; padding:15px 10px 10px 10px; background:#ecebea; border:1px solid #ddd9d3; position:absolute; right:10px; top:30px;">\n\t<div id="pageTotalInfo" style="padding:0 0 10px 0"></div>\n\t<div id="printBtnSelect"><input type="button" value="��ӡȫ��ҳ" onClick="sPrint.PrintAllPage();" />&nbsp;&nbsp;<input type="button" value="��ӡ��ǰҳ" onClick="sPrint.PrintCurPage();" /></div>\n\t<div id="onloadInfo" style="padding:5px 0 0 10px;"></div>\n\t<div id="startPrintDiv" style="display:none; padding:10px 0 0 0;"><input type="button" value="&nbsp;��ӡ&nbsp;" onClick=" sPrint.StartPrintAllPage();" />&nbsp;&nbsp;<input type="button" value="ȡ����ӡ" onClick="sPrint.CancelPrintAllPage();" /></div>\n\t<div style="position:absolute; top:5px; right:3px; width:20px; height:15px; cursor:pointer;" onClick="javascript:sPrint.ClosePrintDialog();"><span onMouseOver="this.style.fontWeight = \'bold\'" onMouseOut="this.style.fontWeight=\'normal\'">��</span></div>\n</div>\n\x3c!-- print dialog end --\x3e\n\x3c!-- iframe start --\x3e\n<div id="allIframe"></div>\n\x3c!-- iframe end --\x3e\n<script language="JavaScript" type="text/javascript">\nsPrint.$ = function(objId){\n\tif(document.getElementById){\n\t\treturn eval(\'document.getElementById("\' + objId + \'")\');\n\t}else if(document.layers){\n\t\treturn eval("document.layers[\'" + objId +"\']");\n\t}else{\n\t\treturn eval(\'document.all.\' + objId);\n\t}\n }\n \n//============================= ѡ���ֺ� start =====================\nsPrint.doPriZoom = function(size){\n\tvar PriCon = sPrint.$("PriCon");\n\tif(!PriCon){\n\t\treturn;\n\t}\n\tvar PriConChild = PriCon.childNodes;\n\tPriCon.style.fontSize = size + "px";\n\tfor(var i = 0; i < PriConChild.length; i++){\n\t\tif(PriConChild[i].nodeType == 1){\n\t\t\tPriConChild[i].style.fontSize = size + "px";\n\t\t\tPriConChild[i].style.lineHeight = size + size + "px";\n\t\t}\n\t}\n\t//������������ ������Ҫֽ����\n\tif(sPrint.startPrint){\n\t\tsPrint.onloadInfoNode.innerHTML = \'��\' + sPrint.pageTotal +\'ҳ��ȫ���������ϣ���Լ��Ҫ\' + sPrint.GetNeedPageTotal() + \'ҳֽ\';\n\t}\n}\nsPrint.ChgFz = function(FZBtn_num){\n\tfor(var i=0;i<4;i++){sPrint.$("topadmenu_"+i).className="NselFZ";}\n\tsPrint.$("topadmenu_"+FZBtn_num).className="selFZ";\n\tfor(var i=0;i<4;i++){sPrint.$("topadmenu2_"+i).className="NselFZ";}\n\tsPrint.$("topadmenu2_"+FZBtn_num).className="selFZ";\n}\nsPrint.ChgFz2 = function(FZBtn_num2){\n\tfor(var i=0;i<4;i++){\n\t\tsPrint.$("topadmenu2_"+i).className="NselFZ";\n\t}\n\tsPrint.$("topadmenu2_"+FZBtn_num2).className="selFZ";\n\tfor(var i=0;i<4;i++){\n\t\tsPrint.$("topadmenu_"+i).className="NselFZ";\n\t}\n\tsPrint.$("topadmenu_"+FZBtn_num2).className="selFZ";\n}\n//============================= ѡ���ֺ� end =====================\n\n//print dialog ����\nsPrint.Scroll = function(o){\n\tvar initTop = parseInt(o.style.top);\n\twindow.onscroll = function(){\n\t\to.style.top = initTop + document.body.scrollTop + "px";\t\t\n   } \n}\n\n//���ض��д���string\nsPrint.BreakWord = function(str,intLen){\n\tvar strTemp = "";\n\tif(str.length > intLen){//���ǻ��ж���\n\t\tstrTemp = "<br />";\n\t}\n\twhile(str.length > intLen){\n\t\tstrTemp += str.substr(0,intLen)+"<br />";\n\t\tstr = str.substr(intLen,str.length);\n\t}\n\treturn strTemp += str;\n}\n\n\n//��ӡ����������Ϣ ����\nsPrint.pagelogoNode \t= sPrint.$("pagelogo");\t\t\t\t//����logo node\nsPrint.artibodyTitleNode= sPrint.$("artibodyTitle"); \t//���±��� node\nsPrint.loLinksNode \t\t= sPrint.$("lo_links");\t\t\t//ҳ��·�� node\nsPrint.priConNode \t\t= sPrint.$("PriCon");\t\t\t//����node\nsPrint.artiPathNode \t= sPrint.$("artiPath");\t\t\t//������Դ node\nsPrint.pageTotal \t\t= sPrint.data.pageUrl.length;\t\t//ҳ������\nsPrint.printDialog \t\t= sPrint.$("printDialog");\t\t//��ӡ�Ի���\nsPrint.onloadInfoNode\t= sPrint.$("onloadInfo"); \t\t//������Ϣ��ʾ node\nsPrint.allIframeNode\t= sPrint.$("allIframe");\t\t//��������ҳ���� node\nsPrint.onloadNum \t\t= 0;\t\t\t\t\t\t\t//��ǰ��ʼ����ҳ����������ֵ\nsPrint.startPrint \t\t= false;\t\t\t\t\t\t//��ǰ�Ƿ��Ѿ�����������д����ҳ�� ��׼����ӡ  �����¶�ҳ��ӡ����\nsPrint.heightPerPage \t= 800; \t\t\t\t\t\t\t//ÿҳֽ���Դ�ӡ�ĸ߶�\nsPrint.pageTotalInfoNode = sPrint.$("pageTotalInfo");\t//ҳ��������Ϣ\nsPrint.printBtnSelectNode = sPrint.$("printBtnSelect");\t//�Ƿ���ӡѡ��node\nsPrint.printImgCheckbox\t = sPrint.$("printImgCheckbox");\t//�Ƿ���ӡͼƬ checkbox\nsPrint.printImgCheckbox2 = sPrint.$("printImgCheckbox2");\t//�Ƿ���ӡͼƬ checkbox �ײ�\nsPrint.printImgOk \t\t= true;\t//Ĭ���Ƿ���ӡͼƬ\nsPrint.imgMaxHeight\t\t= 900;\t//ͼƬ���������߶�\n\n//��ӡ������\nsPrint.Print = function(){\n\t//������ҳ��\n\tif(sPrint.pageTotal == 1){\n\t\twindow.print();\n\t}else if(sPrint.pageTotal > 1){//������ҳ��\n\t\tif(sPrint.onloadNum == 0){\t//��δ��������ҳ ��ʾ��ҳ��ӡ����\n\t\t\t//��ʾ������ҳ��Ҫ��ӡ\n\t\t\tsPrint.pageTotalInfoNode.innerHTML = \'<p>���Ĺ���\' + sPrint.pageTotal + \'ҳ�����Ƿ�ȫ����ӡ��</p>\';\n\t\t\t//�򿪶�ҳ��ӡdialog\n\t\t\tsPrint.OpenPrintDialog();\n\t\t}else if(sPrint.onloadNum < sPrint.pageTotal){\t//�������ڼ���ҳ ����ʾ�ȴ�\n\t\t\t//alert("�����ĵȴ�������ҳ��δ��������.\\n����ȷ����������");\n\t\t\t//�򿪶�ҳ��ӡdialog\n\t\t\tsPrint.OpenPrintDialog();\n\t\t\treturn;\n\t\t}else if(sPrint.startPrint){//������ҳ�Ѿ��������� ��ֱ�Ӵ�ӡ���˳�\n\t\t\twindow.print();\n\t\t\treturn;\n\t\t}\t\t\n\t}\n}\n\n//����ӡ��ǰҳ\nsPrint.PrintCurPage = function(){\n\t//�رմ�ӡdialog\n\tsPrint.ClosePrintDialog();\t\n\t//��ӡ��ǰҳ\n\twindow.print();\n}\n\n//ȫ����ӡ\nsPrint.PrintAllPage = function(){\n\t//���ش�ӡ2����ť\n\tsPrint.printBtnSelectNode.style.display = "none";\n\t//������ʾҳ��������Ϣ\n\tsPrint.pageTotalInfoNode.innerHTML = \'<p>���Ĺ���\' + sPrint.pageTotal + \'ҳ��Ҫ���أ��������ĵȴ�</p>\';\n\t\n\t//���ص�һ��ҳ�� ����ʾ������Ϣ\nsPrint.allIframeNode.innerHTML = \'<iframe id="iframeForData" name="iframeForData" src="\'+sPrint.data.pageUrl[0]+ \'?t=\' + new Date().getTime() + \'" width="0" marginwidth="0" height="0" marginheight="0"  scrolling="no" frameborder="0" onload="sPrint.OnloadBack();" onerror="return true;"></iframe>\';\n\tsPrint.onloadNum = 1;\n\tsPrint.onloadInfoNode.innerHTML = \'��1ҳ���ڼ���...\';\n}\n\n//��ʼ��ӡ����ҳ��\nsPrint.StartPrintAllPage = function(){\t\n\tsPrint.ClosePrintDialog();\t//�ر�dialog\t\n\twindow.print();\t//��ӡ\n}\n\n//ȡ��ȫ����ӡ\nsPrint.CancelPrintAllPage = function(){\t\n\tsPrint.ClosePrintDialog(); //�ر�dialog\n}\n\n//���ص�����ҳ\nsPrint.GoBack = function (){\n\tvar steps = -1;\n\tif(sPrint.onloadNum == 0){\n\tsteps = -1;\n\t}else{\n\t\tsteps = (sPrint.onloadNum) * (-1);\n\t}\n\thistory.go(steps);\n}\n\n//���м���ҳ���Ļص�����\nsPrint.OnloadBack = function(){\n\t//������һ����������Ҫ���ܶ� ��Ϊ��ҳ���� ��������ӡʱ ��Ҫʹ�õ�һҳ��document.title�����⡢ ������Դ����Ϣ\n\tif(sPrint.onloadNum == 1){\n\t\t//����document.title\n\t\t//document.title = frames[\'iframeForData\'].document.title;\n\t\t//���±���\n\t\tsPrint.artibodyTitleNode.innerHTML = frames["iframeForData"].document.getElementById(sPrint.data.titleId).innerHTML;\n\t\t//����������Դ��Ϣ �˵�����\n\t\tsPrint.artiPathNode.innerHTML = sPrint.BreakWord(frames["iframeForData"].location.href.replace(/\\?.*/gi,\'\'),90);\n\t\t//���յ�ǰҳ���� ׼����ҳ½������\n\t\tsPrint.priConNode.innerHTML = "";\n\t}\n\n\t//alert(frames[\'iframeForData\'].location +"///"+sPrint.onloadNum);\t\n\t//�������ݲ��뵽ҳ��ǰ���й���\n\tsPrint.priConNode.innerHTML += sPrint.HandlerBodyHtml(frames[\'iframeForData\'].document.getElementById(sPrint.data.artiBodyId).innerHTML);//iframe ҳ��Ҳ��GetObj ����\n\t//��������������Ϣ\n\tsPrint.onloadInfoNode.innerHTML = \'��\' + sPrint.onloadNum + \'ҳ��������\';\n\t//�����Ƿ�����ҳ����Ҫ����\n\tif(sPrint.onloadNum < sPrint.pageTotal){//������һҳ ����ʾ������Ϣ\n\t\tsPrint.onloadNum++;\n\t\tframes["iframeForData"].location.href = sPrint.data.pageUrl[sPrint.onloadNum - 1] + \'?t=\' + new Date().getTime();\n\t\tsPrint.onloadInfoNode.innerHTML = \'��\'+(sPrint.onloadNum)+\'ҳ���ڼ���...\';\t\t\n\t}else{//�������� ��ʾ����������Ϣ\n\t\t//���� ҳ��������Ϣ\n\t\tsPrint.pageTotalInfoNode.style.display = "none";\n\t\tsPrint.onloadInfoNode.innerHTML = \'��\' + sPrint.pageTotal +\'ҳ��ȫ���������ϣ���Լ��Ҫ\' + sPrint.GetNeedPageTotal() + \'ҳֽ\';\n\t\t//��ʾ��ʼ��ӡ��ť\n\t\tsPrint.$("startPrintDiv").style.display = "block";\n\t\t//�����Ѿ�д������\n\t\tsPrint.startPrint = true;\n\t}\n}\n\n//��������html\nsPrint.HandlerBodyHtml = function(str){\n\tvar strTmp = str;\n\t//�˵� �����ڲ����ֵ���\n\tstrTmp = strTmp.replace(/\x3c!--\\s+�����ڲ����ֵ���\\s+:\\s+begin --\x3e[\\s\\S]*\x3c!--\\s+�����ڲ����ֵ���\\s+:\\s+end\\s+--\x3e/,"");\n\t//ȥ�� artibody�ڴ�ӡ�����Լ��Ժ�������html����\n\tstrTmp = strTmp.replace(/<span\\s+id=["\']?_function_code_page["\']?>[\\s\\S]*/i, "");\n\t//���˵�iask�ؼ��ֵ�html����\n\tstrTmp = strTmp.replace(/<span\\s+class=.?yqlink.?>[\\s\\S]*?class=.?akey.?\\s+title=[\\s\\S]*?>([\\s\\S]*?)<\\/a><\\/span>/gi, "$1");\n\t//����img onload\n\tstrTmp = strTmp.replace(/<img/gi,"<img onload=\\"sPrint.ResizeImg(this);\\"");\n\treturn strTmp;\n}\n\n//���¶��峬��ͼƬ�߶�\nsPrint.ResizeImg = function(obj){\n\tif(obj.height > sPrint.imgMaxHeight){\n\t\tobj.height = sPrint.imgMaxHeight;\n\t\tobj.style.pageBreakAfter = "always";\n\t}\n}\n\n//�򿪴�ӡdialog\nsPrint.OpenPrintDialog = function(){\n\tsPrint.printDialog.style.display = "block";\n}\n//�رմ�ӡdialog\nsPrint.ClosePrintDialog = function(){\n\tsPrint.printDialog.style.display = "none";\n}\n\n//���ش�ӡ����Ҫֽ����\nsPrint.GetNeedPageTotal = function(){\n\tvar needPageTotal;\n\treturn needPageTotal = Math.round(sPrint.priConNode.offsetHeight/sPrint.heightPerPage);\n}\n\n//�Ƿ���ӡͼƬ\nsPrint.printImgCboxChg = function(obj){\n\tif(obj.checked == true){\t\t\n\t\tsPrint.DisplayBodyImg(true);\n\t}else{\n\t\tsPrint.DisplayBodyImg(false);\n\t}\n}\n\n//�Ƿ���ʾ����ͼƬ\nsPrint.DisplayBodyImg = function(bol){\n\tif(bol){\n\t\tsPrint.printImgCheckbox.checked = true;\n\t\tsPrint.printImgCheckbox2.checked = true;\n\t\tsPrint.priConNode.className = "";\n\t\t\n\t\t//��ʾ��ӡͼƬǰ����ͼƬ �ض��峬��ͼƬ�߶�\n\t\tvar imgs = sPrint.priConNode.getElementsByTagName("img");\n\t\tfor(var i = 0; i < imgs.length; i++){\n\t\t\tsPrint.ResizeImg(imgs[i]);\n\t\t}\n\t}else{\n\t\tsPrint.printImgCheckbox.checked = false;\n\t\tsPrint.printImgCheckbox2.checked = false;\n\t\tsPrint.priConNode.className = "noImg";\n\t}\n\t//������������ ���¼�����ӡҳ��\n\tif(sPrint.startPrint){\n\t\tsPrint.onloadInfoNode.innerHTML = \'��\' + sPrint.pageTotal +\'ҳ��ȫ���������ϣ���Լ��Ҫ\' + sPrint.GetNeedPageTotal() + \'ҳֽ\';\t\n\t}\t\n}\n\n\n//��ʼ��\nsPrint.Init = function(){\n\tdocument.title = "";\t//���õ�ǰҳtitle ������ӡ��\t\t\n\tsPrint.pagelogoNode.innerHTML \t= unescape(sPrint.data.pageLogoHtml);\t//��ʾҳ��logo\n\tsPrint.loLinksNode.innerHTML \t= unescape(sPrint.data.pageWayHtml).replace(/#000099/g,"#000000");\t//��ʾҳ��·�� ��ʹ�ú�ɫ\n\tsPrint.artibodyTitleNode.innerHTML = unescape(sPrint.data.titleHtml);\t//��ʾҳ������\n\tsPrint.priConNode.innerHTML \t= sPrint.HandlerBodyHtml(unescape(sPrint.data.artiBodyHtml));\t//��ʾ��ǰҳ����\n\tsPrint.artiPathNode.innerHTML \t= sPrint.BreakWord(location.href,92);\t//��ʾ������Դurl δ���Ƕ���\n\tsPrint.Scroll(sPrint.printDialog);\t\t//printDialog ����\t\n\t//��λprintDialog�ĳ�ʼλ��\n\t//��css��λ\n}\nsPrint.Init();\n//����sPrint.printImgOk ��ʼ��checkbox ����ie��ˢ�º���¼��ǰcheckbox״̬��bug\nwindow.onload=function(){\n\tif(sPrint.printImgOk){\n\t\tsPrint.DisplayBodyImg(true);\n\t}else{\n\t\tsPrint.DisplayBodyImg(false);\n\t}\n}\n<\/script>\n</body>\n</html>',document.write(t),document.close()};