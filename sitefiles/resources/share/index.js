var $url="/share",$urlWxShare="/share/wxShare",$urlSettings="/share/settings",data=utils.init({siteId:utils.getQueryInt("siteId"),siteUrl:null,ipAddress:null,settingsForm:null,wxShareForm:null,mpResult:null}),methods={runFormLayerImageUploadText:function(t,i,e){this.insertText(t,i,e)},runMaterialLayerImageSelect:function(t,i,e){this.insertText(t,i,e)},insertText:function(t,i,e){this.settingsForm[t]=e,this.settingsForm=_.assign({},this.settingsForm)},apiGet:function(){var t=this;utils.loading(this,!0),$api.get($url,{params:{siteId:this.siteId}}).then(function(i){var e=i.data;t.siteUrl=e.siteUrl,t.ipAddress=e.ipAddress,t.settingsForm=Object.assign({},e.settings),t.wxShareForm=Object.assign({},e.settings)}).catch(function(t){utils.error(t)}).then(function(){utils.loading(t,!1)})},apiWxShareSubmit:function(){this.mpResult=null;var t=this;utils.loading(this,!0),$api.post($urlWxShare,{siteId:this.siteId,isWxShare:this.wxShareForm.isWxShare,mpAppId:this.wxShareForm.mpAppId,mpAppSecret:this.wxShareForm.mpAppSecret}).then(function(i){var e=i.data;t.mpResult={success:e.success,errorMessage:e.errorMessage}}).catch(function(t){utils.error(t)}).then(function(){utils.loading(t,!1)})},apiSettingsSubmit:function(){var t=this;utils.loading(this,!0),$api.post($urlSettings,{siteId:this.siteId,defaultTitle:this.settingsForm.defaultTitle,defaultImageUrl:this.settingsForm.defaultImageUrl,defaultDescription:this.settingsForm.defaultDescription}).then(function(t){t.data;utils.success("页面分享设置保存成功！")}).catch(function(t){utils.error(t)}).then(function(){utils.loading(t,!1)})},btnSettingsSubmitClick:function(){var t=this;this.$refs.settingsForm.validate(function(i){i&&t.apiSettingsSubmit()})},btnWxShareSubmitClick:function(){var t=this;this.$refs.wxShareForm.validate(function(i){i&&t.apiWxShareSubmit()})},btnLayerClick:function(t){var i={siteId:this.siteId,channelId:this.channelId};t.contentId&&(i.contentId=t.contentId),t.attributeName&&(i.attributeName=t.attributeName),t.no&&(i.no=t.no);var e={title:t.title,url:utils.getCommonUrl(t.name,i)};t.full||(e.width=t.width?t.width:700,e.height=t.height?t.height:500),utils.openLayer(e)},btnPreviewClick:function(t,i){var e=[],s=this.settingsForm.defaultImageUrl;s=utils.getUrl(this.siteUrl,s),e.push({src:s}),layer.photos({photos:{start:i,data:e},anim:5})}},$vue=new Vue({el:"#main",data:data,methods:methods,created:function(){this.apiGet()}});