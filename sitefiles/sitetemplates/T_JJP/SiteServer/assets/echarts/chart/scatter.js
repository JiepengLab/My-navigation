define("echarts/chart/scatter",["require","./base","../util/shape/Symbol","../component/axis","../component/grid","../component/dataZoom","../component/dataRange","../config","zrender/tool/util","zrender/tool/color","../chart"],function(t){function e(t,e,a,s,h){i.call(this,t,e,a,s,h),this.refresh(s)}var i=t("./base"),a=t("../util/shape/Symbol");t("../component/axis"),t("../component/grid"),t("../component/dataZoom"),t("../component/dataRange");var s=t("../config");s.scatter={zlevel:0,z:2,clickable:!0,legendHoverLink:!0,xAxisIndex:0,yAxisIndex:0,symbolSize:4,large:!1,largeThreshold:2e3,itemStyle:{normal:{label:{show:!1}},emphasis:{label:{show:!1}}}};var h=t("zrender/tool/util"),n=t("zrender/tool/color");return e.prototype={type:s.CHART_TYPE_SCATTER,_buildShape:function(){var t=this.series;this._sIndex2ColorMap={},this._symbol=this.option.symbolList,this._sIndex2ShapeMap={},this.selectedMap={},this.xMarkMap={};for(var e,i,a,h,o=this.component.legend,l=[],r=0,d=t.length;d>r;r++)if(e=t[r],i=e.name,e.type===s.CHART_TYPE_SCATTER){if(t[r]=this.reformOption(t[r]),this.legendHoverLink=t[r].legendHoverLink||this.legendHoverLink,this._sIndex2ShapeMap[r]=this.query(e,"symbol")||this._symbol[r%this._symbol.length],o){if(this.selectedMap[i]=o.isSelected(i),this._sIndex2ColorMap[r]=n.alpha(o.getColor(i),.5),a=o.getItemShape(i)){var h=this._sIndex2ShapeMap[r];a.style.brushType=h.match("empty")?"stroke":"both",h=h.replace("empty","").toLowerCase(),h.match("rectangle")&&(a.style.x+=Math.round((a.style.width-a.style.height)/2),a.style.width=a.style.height),h.match("star")&&(a.style.n=h.replace("star","")-0||5,h="star"),h.match("image")&&(a.style.image=h.replace(new RegExp("^image:\\/\\/"),""),a.style.x+=Math.round((a.style.width-a.style.height)/2),a.style.width=a.style.height,h="image"),a.style.iconType=h,o.setItemShape(i,a)}}else this.selectedMap[i]=!0,this._sIndex2ColorMap[r]=n.alpha(this.zr.getColor(r),.5);this.selectedMap[i]&&l.push(r)}this._buildSeries(l),this.addShapeList()},_buildSeries:function(t){if(0!==t.length){for(var e,i,a,s,h,n,o,l,r=this.series,d={},p=0,g=t.length;g>p;p++)if(e=t[p],i=r[e],0!==i.data.length){h=this.component.xAxis.getAxis(i.xAxisIndex||0),n=this.component.yAxis.getAxis(i.yAxisIndex||0),d[e]=[];for(var _=0,c=i.data.length;c>_;_++)a=i.data[_],"-"===(s=this.getDataFromOption(a,"-"))||s.length<2||(o=h.getCoord(s[0]),l=n.getCoord(s[1]),d[e].push([o,l,_,a.name||""]));this.xMarkMap[e]=this._markMap(h,n,i.data,d[e]),this.buildMark(e)}this._buildPointList(d)}},_markMap:function(t,e,i,a){for(var s,h={min0:Number.POSITIVE_INFINITY,max0:Number.NEGATIVE_INFINITY,sum0:0,counter0:0,average0:0,min1:Number.POSITIVE_INFINITY,max1:Number.NEGATIVE_INFINITY,sum1:0,counter1:0,average1:0},n=0,o=a.length;o>n;n++)s=i[a[n][2]].value||i[a[n][2]],h.min0>s[0]&&(h.min0=s[0],h.minY0=a[n][1],h.minX0=a[n][0]),h.max0<s[0]&&(h.max0=s[0],h.maxY0=a[n][1],h.maxX0=a[n][0]),h.sum0+=s[0],h.counter0++,h.min1>s[1]&&(h.min1=s[1],h.minY1=a[n][1],h.minX1=a[n][0]),h.max1<s[1]&&(h.max1=s[1],h.maxY1=a[n][1],h.maxX1=a[n][0]),h.sum1+=s[1],h.counter1++;var l=this.component.grid.getX(),r=this.component.grid.getXend(),d=this.component.grid.getY(),p=this.component.grid.getYend();h.average0=h.sum0/h.counter0;var g=t.getCoord(h.average0);h.averageLine0=[[g,p],[g,d]],h.minLine0=[[h.minX0,p],[h.minX0,d]],h.maxLine0=[[h.maxX0,p],[h.maxX0,d]],h.average1=h.sum1/h.counter1;var _=e.getCoord(h.average1);return h.averageLine1=[[l,_],[r,_]],h.minLine1=[[l,h.minY1],[r,h.minY1]],h.maxLine1=[[l,h.maxY1],[r,h.maxY1]],h},_buildPointList:function(t){var e,i,a,s,h=this.series;for(var n in t)if(e=h[n],i=t[n],e.large&&e.data.length>e.largeThreshold)this.shapeList.push(this._getLargeSymbol(e,i,this.getItemStyleColor(this.query(e,"itemStyle.normal.color"),n,-1)||this._sIndex2ColorMap[n]));else for(var o=0,l=i.length;l>o;o++)a=i[o],(s=this._getSymbol(n,a[2],a[3],a[0],a[1]))&&this.shapeList.push(s)},_getSymbol:function(t,e,i,a,s){var h,n=this.series,o=n[t],l=o.data[e],r=this.component.dataRange;if(r){if(!(h=isNaN(l[2])?this._sIndex2ColorMap[t]:r.getColor(l[2])))return null}else h=this._sIndex2ColorMap[t];var d=this.getSymbolShape(o,t,l,e,i,a,s,this._sIndex2ShapeMap[t],h,"rgba(0,0,0,0)","vertical");return d.zlevel=o.zlevel,d.z=o.z,d._main=!0,d},_getLargeSymbol:function(t,e,i){return new a({zlevel:t.zlevel,z:t.z,_main:!0,hoverable:!1,style:{pointList:e,color:i,strokeColor:i},highlightStyle:{pointList:[]}})},getMarkCoord:function(t,e){var i,a=this.series[t],s=this.xMarkMap[t],h=this.component.xAxis.getAxis(a.xAxisIndex),n=this.component.yAxis.getAxis(a.yAxisIndex);if(!e.type||"max"!==e.type&&"min"!==e.type&&"average"!==e.type)i=["string"!=typeof e.xAxis&&h.getCoordByIndex?h.getCoordByIndex(e.xAxis||0):h.getCoord(e.xAxis||0),"string"!=typeof e.yAxis&&n.getCoordByIndex?n.getCoordByIndex(e.yAxis||0):n.getCoord(e.yAxis||0)];else{var o=null!=e.valueIndex?e.valueIndex:1;i=[s[e.type+"X"+o],s[e.type+"Y"+o],s[e.type+"Line"+o],s[e.type+o]]}return i},refresh:function(t){t&&(this.option=t,this.series=t.series),this.backupShapeList(),this._buildShape()},ondataRange:function(t,e){this.component.dataRange&&(this.refresh(),e.needRefresh=!0)}},h.inherits(e,i),t("../chart").define("scatter",e),e}),define("echarts/component/dataRange",["require","./base","zrender/shape/Text","zrender/shape/Rectangle","../util/shape/HandlePolygon","../config","zrender/tool/util","zrender/tool/event","zrender/tool/area","zrender/tool/color","../component"],function(t){function e(t,e,a,s,h){i.call(this,t,e,a,s,h);var o=this;o._ondrift=function(t,e){return o.__ondrift(this,t,e)},o._ondragend=function(){return o.__ondragend()},o._dataRangeSelected=function(t){return o.__dataRangeSelected(t)},o._dispatchHoverLink=function(t){return o.__dispatchHoverLink(t)},o._onhoverlink=function(t){return o.__onhoverlink(t)},this._selectedMap={},this._range={},this.refresh(s),e.bind(n.EVENT.HOVER,this._onhoverlink)}var i=t("./base"),a=t("zrender/shape/Text"),s=t("zrender/shape/Rectangle"),h=t("../util/shape/HandlePolygon"),n=t("../config");n.dataRange={zlevel:0,z:4,show:!0,orient:"vertical",x:"left",y:"bottom",backgroundColor:"rgba(0,0,0,0)",borderColor:"#ccc",borderWidth:0,padding:5,itemGap:10,itemWidth:20,itemHeight:14,precision:0,splitNumber:5,splitList:null,calculable:!1,selectedMode:!0,hoverLink:!0,realtime:!0,color:["#006edd","#e0ffff"],textStyle:{color:"#333"}};var o=t("zrender/tool/util"),l=t("zrender/tool/event"),r=t("zrender/tool/area"),d=t("zrender/tool/color");return e.prototype={type:n.COMPONENT_TYPE_DATARANGE,_textGap:10,_buildShape:function(){if(this._itemGroupLocation=this._getItemGroupLocation(),this._buildBackground(),this._isContinuity()?this._buildGradient():this._buildItem(),this.dataRangeOption.show)for(var t=0,e=this.shapeList.length;e>t;t++)this.zr.addShape(this.shapeList[t]);this._syncShapeFromRange()},_buildItem:function(){var t,e,i,h,n=this._valueTextList,o=n.length,l=this.getFont(this.dataRangeOption.textStyle),d=this._itemGroupLocation.x,p=this._itemGroupLocation.y,g=this.dataRangeOption.itemWidth,_=this.dataRangeOption.itemHeight,c=this.dataRangeOption.itemGap,x=r.getTextHeight("国",l);"vertical"==this.dataRangeOption.orient&&"right"==this.dataRangeOption.x&&(d=this._itemGroupLocation.x+this._itemGroupLocation.width-g);var u=!0;this.dataRangeOption.text&&(u=!1,this.dataRangeOption.text[0]&&(i=this._getTextShape(d,p,this.dataRangeOption.text[0]),"horizontal"==this.dataRangeOption.orient?d+=r.getTextWidth(this.dataRangeOption.text[0],l)+this._textGap:(p+=x+this._textGap,i.style.y+=x/2+this._textGap,i.style.textBaseline="bottom"),this.shapeList.push(new a(i))));for(var y=0;o>y;y++)t=n[y],h=this.getColorByIndex(y),e=this._getItemShape(d,p,g,_,this._selectedMap[y]?h:"#ccc"),e._idx=y,e.onmousemove=this._dispatchHoverLink,this.dataRangeOption.selectedMode&&(e.clickable=!0,e.onclick=this._dataRangeSelected),this.shapeList.push(new s(e)),u&&(i={zlevel:this.getZlevelBase(),z:this.getZBase(),style:{x:d+g+5,y:p,color:this._selectedMap[y]?this.dataRangeOption.textStyle.color:"#ccc",text:n[y],textFont:l,textBaseline:"top"},highlightStyle:{brushType:"fill"}},"vertical"==this.dataRangeOption.orient&&"right"==this.dataRangeOption.x&&(i.style.x-=g+10,i.style.textAlign="right"),i._idx=y,i.onmousemove=this._dispatchHoverLink,this.dataRangeOption.selectedMode&&(i.clickable=!0,i.onclick=this._dataRangeSelected),this.shapeList.push(new a(i))),"horizontal"==this.dataRangeOption.orient?d+=g+(u?5:0)+(u?r.getTextWidth(t,l):0)+c:p+=_+c;!u&&this.dataRangeOption.text[1]&&("horizontal"==this.dataRangeOption.orient?d=d-c+this._textGap:p=p-c+this._textGap,i=this._getTextShape(d,p,this.dataRangeOption.text[1]),"horizontal"!=this.dataRangeOption.orient&&(i.style.y-=5,i.style.textBaseline="top"),this.shapeList.push(new a(i)))},_buildGradient:function(){var e,i,h=this.getFont(this.dataRangeOption.textStyle),n=this._itemGroupLocation.x,o=this._itemGroupLocation.y,l=this.dataRangeOption.itemWidth,d=this.dataRangeOption.itemHeight,p=r.getTextHeight("国",h),g=10,_=!0;this.dataRangeOption.text&&(_=!1,this.dataRangeOption.text[0]&&(i=this._getTextShape(n,o,this.dataRangeOption.text[0]),"horizontal"==this.dataRangeOption.orient?n+=r.getTextWidth(this.dataRangeOption.text[0],h)+this._textGap:(o+=p+this._textGap,i.style.y+=p/2+this._textGap,i.style.textBaseline="bottom"),this.shapeList.push(new a(i))));for(var c=t("zrender/tool/color"),x=1/(this.dataRangeOption.color.length-1),u=[],y=0,m=this.dataRangeOption.color.length;m>y;y++)u.push([y*x,this.dataRangeOption.color[y]]);"horizontal"==this.dataRangeOption.orient?(e={zlevel:this.getZlevelBase(),z:this.getZBase(),style:{x:n,y:o,width:l*g,height:d,color:c.getLinearGradient(n,o,n+l*g,o,u)},hoverable:!1},n+=l*g+this._textGap):(e={zlevel:this.getZlevelBase(),z:this.getZBase(),style:{x:n,y:o,width:l,height:d*g,color:c.getLinearGradient(n,o,n,o+d*g,u)},hoverable:!1},o+=d*g+this._textGap),this.shapeList.push(new s(e)),this._calculableLocation=e.style,this.dataRangeOption.calculable&&(this._buildFiller(),this._bulidMask(),this._bulidHandle()),this._buildIndicator(),!_&&this.dataRangeOption.text[1]&&(i=this._getTextShape(n,o,this.dataRangeOption.text[1]),this.shapeList.push(new a(i)))},_buildIndicator:function(){var t,e,i=this._calculableLocation.x,a=this._calculableLocation.y,s=this._calculableLocation.width,n=this._calculableLocation.height;"horizontal"==this.dataRangeOption.orient?"bottom"!=this.dataRangeOption.y?(t=[[i,a+n],[i-5,a+n+5],[i+5,a+n+5]],e="bottom"):(t=[[i,a],[i-5,a-5],[i+5,a-5]],e="top"):"right"!=this.dataRangeOption.x?(t=[[i+s,a],[i+s+5,a-5],[i+s+5,a+5]],e="right"):(t=[[i,a],[i-5,a-5],[i-5,a+5]],e="left"),this._indicatorShape={style:{pointList:t,color:"#fff",__rect:{x:Math.min(t[0][0],t[1][0]),y:Math.min(t[0][1],t[1][1]),width:5*("horizontal"==this.dataRangeOption.orient?2:1),height:5*("horizontal"==this.dataRangeOption.orient?1:2)}},highlightStyle:{brushType:"fill",textPosition:e,textColor:this.dataRangeOption.textStyle.color},hoverable:!1},this._indicatorShape=new h(this._indicatorShape)},_buildFiller:function(){this._fillerShape={zlevel:this.getZlevelBase(),z:this.getZBase()+1,style:{x:this._calculableLocation.x,y:this._calculableLocation.y,width:this._calculableLocation.width,height:this._calculableLocation.height,color:"rgba(255,255,255,0)"},highlightStyle:{strokeColor:"rgba(255,255,255,0.5)",lineWidth:1},draggable:!0,ondrift:this._ondrift,ondragend:this._ondragend,onmousemove:this._dispatchHoverLink,_type:"filler"},this._fillerShape=new s(this._fillerShape),this.shapeList.push(this._fillerShape)},_bulidHandle:function(){var t,e,i,a,s,n,o,l,d=this._calculableLocation.x,p=this._calculableLocation.y,g=this._calculableLocation.width,_=this._calculableLocation.height,c=this.getFont(this.dataRangeOption.textStyle),x=r.getTextHeight("国",c),u=Math.max(r.getTextWidth(this._textFormat(this.dataRangeOption.max),c),r.getTextWidth(this._textFormat(this.dataRangeOption.min),c))+2;"horizontal"==this.dataRangeOption.orient?"bottom"!=this.dataRangeOption.y?(t=[[d,p],[d,p+_+x],[d-x,p+_+x],[d-1,p+_],[d-1,p]],e=d-u/2-x,i=p+_+x/2+2,a={x:d-u-x,y:p+_,width:u+x,height:x},s=[[d+g,p],[d+g,p+_+x],[d+g+x,p+_+x],[d+g+1,p+_],[d+g+1,p]],n=d+g+u/2+x,o=i,l={x:d+g,y:p+_,width:u+x,height:x}):(t=[[d,p+_],[d,p-x],[d-x,p-x],[d-1,p],[d-1,p+_]],e=d-u/2-x,i=p-x/2-2,a={x:d-u-x,y:p-x,width:u+x,height:x},s=[[d+g,p+_],[d+g,p-x],[d+g+x,p-x],[d+g+1,p],[d+g+1,p+_]],n=d+g+u/2+x,o=i,l={x:d+g,y:p-x,width:u+x,height:x}):(u+=x,"right"!=this.dataRangeOption.x?(t=[[d,p],[d+g+x,p],[d+g+x,p-x],[d+g,p-1],[d,p-1]],e=d+g+u/2+x/2,i=p-x/2,a={x:d+g,y:p-x,width:u+x,height:x},s=[[d,p+_],[d+g+x,p+_],[d+g+x,p+x+_],[d+g,p+1+_],[d,p+_+1]],n=e,o=p+_+x/2,l={x:d+g,y:p+_,width:u+x,height:x}):(t=[[d+g,p],[d-x,p],[d-x,p-x],[d,p-1],[d+g,p-1]],e=d-u/2-x/2,i=p-x/2,a={x:d-u-x,y:p-x,width:u+x,height:x},s=[[d+g,p+_],[d-x,p+_],[d-x,p+x+_],[d,p+1+_],[d+g,p+_+1]],n=e,o=p+_+x/2,l={x:d-u-x,y:p+_,width:u+x,height:x})),this._startShape={style:{pointList:t,text:this._textFormat(this.dataRangeOption.max),textX:e,textY:i,textFont:c,color:this.getColor(this.dataRangeOption.max),rect:a,x:t[0][0],y:t[0][1],_x:t[0][0],_y:t[0][1]}},this._startShape.highlightStyle={strokeColor:this._startShape.style.color,lineWidth:1},this._endShape={style:{pointList:s,text:this._textFormat(this.dataRangeOption.min),textX:n,textY:o,textFont:c,color:this.getColor(this.dataRangeOption.min),rect:l,x:s[0][0],y:s[0][1],_x:s[0][0],_y:s[0][1]}},this._endShape.highlightStyle={strokeColor:this._endShape.style.color,lineWidth:1},this._startShape.zlevel=this._endShape.zlevel=this.getZlevelBase(),this._startShape.z=this._endShape.z=this.getZBase()+1,this._startShape.draggable=this._endShape.draggable=!0,this._startShape.ondrift=this._endShape.ondrift=this._ondrift,this._startShape.ondragend=this._endShape.ondragend=this._ondragend,this._startShape.style.textColor=this._endShape.style.textColor=this.dataRangeOption.textStyle.color,this._startShape.style.textAlign=this._endShape.style.textAlign="center",this._startShape.style.textPosition=this._endShape.style.textPosition="specific",this._startShape.style.textBaseline=this._endShape.style.textBaseline="middle",this._startShape.style.width=this._endShape.style.width=0,this._startShape.style.height=this._endShape.style.height=0,this._startShape.style.textPosition=this._endShape.style.textPosition="specific",this._startShape=new h(this._startShape),this._endShape=new h(this._endShape),this.shapeList.push(this._startShape),this.shapeList.push(this._endShape)},_bulidMask:function(){var t=this._calculableLocation.x,e=this._calculableLocation.y,i=this._calculableLocation.width,a=this._calculableLocation.height;this._startMask={zlevel:this.getZlevelBase(),z:this.getZBase()+1,style:{x:t,y:e,width:"horizontal"==this.dataRangeOption.orient?0:i,height:"horizontal"==this.dataRangeOption.orient?a:0,color:"#ccc"},hoverable:!1},this._endMask={zlevel:this.getZlevelBase(),z:this.getZBase()+1,style:{x:"horizontal"==this.dataRangeOption.orient?t+i:t,y:"horizontal"==this.dataRangeOption.orient?e:e+a,width:"horizontal"==this.dataRangeOption.orient?0:i,height:"horizontal"==this.dataRangeOption.orient?a:0,color:"#ccc"},hoverable:!1},this._startMask=new s(this._startMask),this._endMask=new s(this._endMask),this.shapeList.push(this._startMask),this.shapeList.push(this._endMask)},_buildBackground:function(){var t=this.reformCssArray(this.dataRangeOption.padding);this.shapeList.push(new s({zlevel:this.getZlevelBase(),z:this.getZBase(),hoverable:!1,style:{x:this._itemGroupLocation.x-t[3],y:this._itemGroupLocation.y-t[0],width:this._itemGroupLocation.width+t[3]+t[1],height:this._itemGroupLocation.height+t[0]+t[2],brushType:0===this.dataRangeOption.borderWidth?"fill":"both",color:this.dataRangeOption.backgroundColor,strokeColor:this.dataRangeOption.borderColor,lineWidth:this.dataRangeOption.borderWidth}}))},_getItemGroupLocation:function(){var t=this._valueTextList,e=t.length,i=this.dataRangeOption.itemGap,a=this.dataRangeOption.itemWidth,s=this.dataRangeOption.itemHeight,h=0,n=0,o=this.getFont(this.dataRangeOption.textStyle),l=r.getTextHeight("国",o);if("horizontal"==this.dataRangeOption.orient){if(this.dataRangeOption.text||this._isContinuity())h=(this._isContinuity()?10*a+i:e*(a+i))+(this.dataRangeOption.text&&void 0!==this.dataRangeOption.text[0]?r.getTextWidth(this.dataRangeOption.text[0],o)+this._textGap:0)+(this.dataRangeOption.text&&void 0!==this.dataRangeOption.text[1]?r.getTextWidth(this.dataRangeOption.text[1],o)+this._textGap:0);else{a+=5;for(var d=0;e>d;d++)h+=a+r.getTextWidth(t[d],o)+i}h-=i,n=Math.max(l,s)}else{var p;if(this.dataRangeOption.text||this._isContinuity())n=(this._isContinuity()?10*s+i:e*(s+i))+(this.dataRangeOption.text&&void 0!==this.dataRangeOption.text[0]?this._textGap+l:0)+(this.dataRangeOption.text&&void 0!==this.dataRangeOption.text[1]?this._textGap+l:0),p=Math.max(r.getTextWidth(this.dataRangeOption.text&&this.dataRangeOption.text[0]||"",o),r.getTextWidth(this.dataRangeOption.text&&this.dataRangeOption.text[1]||"",o)),h=Math.max(a,p);else{n=(s+i)*e,a+=5,p=0;for(var d=0;e>d;d++)p=Math.max(p,r.getTextWidth(t[d],o));h=a+p}n-=i}var g,_=this.reformCssArray(this.dataRangeOption.padding),c=this.zr.getWidth();switch(this.dataRangeOption.x){case"center":g=Math.floor((c-h)/2);break;case"left":g=_[3]+this.dataRangeOption.borderWidth;break;case"right":g=c-h-_[1]-this.dataRangeOption.borderWidth;break;default:g=this.parsePercent(this.dataRangeOption.x,c),g=isNaN(g)?0:g}var x,u=this.zr.getHeight();switch(this.dataRangeOption.y){case"top":x=_[0]+this.dataRangeOption.borderWidth;break;case"bottom":x=u-n-_[2]-this.dataRangeOption.borderWidth;break;case"center":x=Math.floor((u-n)/2);break;default:x=this.parsePercent(this.dataRangeOption.y,u),x=isNaN(x)?0:x}if(this.dataRangeOption.calculable){var y=Math.max(r.getTextWidth(this.dataRangeOption.max,o),r.getTextWidth(this.dataRangeOption.min,o))+l;"horizontal"==this.dataRangeOption.orient?(y>g&&(g=y),g+h+y>c&&(g-=y)):(l>x&&(x=l),x+n+l>u&&(x-=l))}return{x:g,y:x,width:h,height:n}},_getTextShape:function(t,e,i){return{zlevel:this.getZlevelBase(),z:this.getZBase(),style:{x:"horizontal"==this.dataRangeOption.orient?t:this._itemGroupLocation.x+this._itemGroupLocation.width/2,y:"horizontal"==this.dataRangeOption.orient?this._itemGroupLocation.y+this._itemGroupLocation.height/2:e,color:this.dataRangeOption.textStyle.color,text:i,textFont:this.getFont(this.dataRangeOption.textStyle),textBaseline:"horizontal"==this.dataRangeOption.orient?"middle":"top",textAlign:"horizontal"==this.dataRangeOption.orient?"left":"center"},hoverable:!1}},_getItemShape:function(t,e,i,a,s){return{zlevel:this.getZlevelBase(),z:this.getZBase(),style:{x:t,y:e+1,width:i,height:a-2,color:s},highlightStyle:{strokeColor:s,lineWidth:1}}},__ondrift:function(t,e,i){var a=this._calculableLocation.x,s=this._calculableLocation.y,h=this._calculableLocation.width,n=this._calculableLocation.height;return"horizontal"==this.dataRangeOption.orient?t.style.x+e<=a?t.style.x=a:t.style.x+e+t.style.width>=a+h?t.style.x=a+h-t.style.width:t.style.x+=e:t.style.y+i<=s?t.style.y=s:t.style.y+i+t.style.height>=s+n?t.style.y=s+n-t.style.height:t.style.y+=i,"filler"==t._type?this._syncHandleShape():this._syncFillerShape(t),this.dataRangeOption.realtime&&this._dispatchDataRange(),!0},__ondragend:function(){this.isDragend=!0},ondragend:function(t,e){this.isDragend&&t.target&&(e.dragOut=!0,e.dragIn=!0,this.dataRangeOption.realtime||this._dispatchDataRange(),e.needRefresh=!1,this.isDragend=!1)},_syncShapeFromRange:function(){var t=this.dataRangeOption.range||{},e=t.start,i=t.end;if(e>i&&(e=[i,i=e][0]),this._range.end=null!=e?e:null!=this._range.end?this._range.end:0,this._range.start=null!=i?i:null!=this._range.start?this._range.start:100,100!=this._range.start||0!==this._range.end){if("horizontal"==this.dataRangeOption.orient){var a=this._fillerShape.style.width;this._fillerShape.style.x+=a*(100-this._range.start)/100,this._fillerShape.style.width=a*(this._range.start-this._range.end)/100}else{var s=this._fillerShape.style.height;this._fillerShape.style.y+=s*(100-this._range.start)/100,this._fillerShape.style.height=s*(this._range.start-this._range.end)/100}this.zr.modShape(this._fillerShape.id),this._syncHandleShape()}},_syncHandleShape:function(){var t=this._calculableLocation.x,e=this._calculableLocation.y,i=this._calculableLocation.width,a=this._calculableLocation.height;"horizontal"==this.dataRangeOption.orient?(this._startShape.style.x=this._fillerShape.style.x,this._startMask.style.width=this._startShape.style.x-t,this._endShape.style.x=this._fillerShape.style.x+this._fillerShape.style.width,this._endMask.style.x=this._endShape.style.x,this._endMask.style.width=t+i-this._endShape.style.x,this._range.start=Math.ceil(100-(this._startShape.style.x-t)/i*100),this._range.end=Math.floor(100-(this._endShape.style.x-t)/i*100)):(this._startShape.style.y=this._fillerShape.style.y,this._startMask.style.height=this._startShape.style.y-e,this._endShape.style.y=this._fillerShape.style.y+this._fillerShape.style.height,this._endMask.style.y=this._endShape.style.y,this._endMask.style.height=e+a-this._endShape.style.y,this._range.start=Math.ceil(100-(this._startShape.style.y-e)/a*100),this._range.end=Math.floor(100-(this._endShape.style.y-e)/a*100)),this._syncShape()},_syncFillerShape:function(t){var e,i,a=this._calculableLocation.x,s=this._calculableLocation.y,h=this._calculableLocation.width,n=this._calculableLocation.height;"horizontal"==this.dataRangeOption.orient?(e=this._startShape.style.x,i=this._endShape.style.x,t.id==this._startShape.id&&e>=i?(i=e,this._endShape.style.x=e):t.id==this._endShape.id&&e>=i&&(e=i,this._startShape.style.x=e),this._fillerShape.style.x=e,this._fillerShape.style.width=i-e,this._startMask.style.width=e-a,this._endMask.style.x=i,this._endMask.style.width=a+h-i,this._range.start=Math.ceil(100-(e-a)/h*100),this._range.end=Math.floor(100-(i-a)/h*100)):(e=this._startShape.style.y,i=this._endShape.style.y,t.id==this._startShape.id&&e>=i?(i=e,this._endShape.style.y=e):t.id==this._endShape.id&&e>=i&&(e=i,this._startShape.style.y=e),this._fillerShape.style.y=e,this._fillerShape.style.height=i-e,this._startMask.style.height=e-s,this._endMask.style.y=i,this._endMask.style.height=s+n-i,this._range.start=Math.ceil(100-(e-s)/n*100),this._range.end=Math.floor(100-(i-s)/n*100)),this._syncShape()},_syncShape:function(){this._startShape.position=[this._startShape.style.x-this._startShape.style._x,this._startShape.style.y-this._startShape.style._y],this._startShape.style.text=this._textFormat(this._gap*this._range.start+this.dataRangeOption.min),this._startShape.style.color=this._startShape.highlightStyle.strokeColor=this.getColor(this._gap*this._range.start+this.dataRangeOption.min),this._endShape.position=[this._endShape.style.x-this._endShape.style._x,this._endShape.style.y-this._endShape.style._y],this._endShape.style.text=this._textFormat(this._gap*this._range.end+this.dataRangeOption.min),this._endShape.style.color=this._endShape.highlightStyle.strokeColor=this.getColor(this._gap*this._range.end+this.dataRangeOption.min),this.zr.modShape(this._startShape.id),this.zr.modShape(this._endShape.id),this.zr.modShape(this._startMask.id),this.zr.modShape(this._endMask.id),this.zr.modShape(this._fillerShape.id),this.zr.refreshNextFrame()},_dispatchDataRange:function(){this.messageCenter.dispatch(n.EVENT.DATA_RANGE,null,{range:{start:this._range.end,end:this._range.start}},this.myChart)},__dataRangeSelected:function(t){if("single"===this.dataRangeOption.selectedMode)for(var e in this._selectedMap)this._selectedMap[e]=!1;var i=t.target._idx;this._selectedMap[i]=!this._selectedMap[i];var a,s;this._useCustomizedSplit()?(a=this._splitList[i].max,s=this._splitList[i].min):(a=(this._colorList.length-i)*this._gap+this.dataRangeOption.min,s=a-this._gap),this.messageCenter.dispatch(n.EVENT.DATA_RANGE_SELECTED,t.event,{selected:this._selectedMap,target:i,valueMax:a,valueMin:s},this.myChart),this.messageCenter.dispatch(n.EVENT.REFRESH,null,null,this.myChart)},__dispatchHoverLink:function(t){var e,i;if(this.dataRangeOption.calculable){var a,s=this.dataRangeOption.max-this.dataRangeOption.min;a="horizontal"==this.dataRangeOption.orient?(1-(l.getX(t.event)-this._calculableLocation.x)/this._calculableLocation.width)*s:(1-(l.getY(t.event)-this._calculableLocation.y)/this._calculableLocation.height)*s,e=a-.05*s,i=a+.05*s}else if(this._useCustomizedSplit()){var h=t.target._idx;i=this._splitList[h].max,e=this._splitList[h].min}else{var h=t.target._idx;i=(this._colorList.length-h)*this._gap+this.dataRangeOption.min,e=i-this._gap}this.messageCenter.dispatch(n.EVENT.DATA_RANGE_HOVERLINK,t.event,{valueMin:e,valueMax:i},this.myChart)},__onhoverlink:function(t){if(this.dataRangeOption.show&&this.dataRangeOption.hoverLink&&this._indicatorShape&&t&&null!=t.seriesIndex&&null!=t.dataIndex){var e=t.value;if(""===e||isNaN(e))return;e<this.dataRangeOption.min?e=this.dataRangeOption.min:e>this.dataRangeOption.max&&(e=this.dataRangeOption.max),this._indicatorShape.position="horizontal"==this.dataRangeOption.orient?[(this.dataRangeOption.max-e)/(this.dataRangeOption.max-this.dataRangeOption.min)*this._calculableLocation.width,0]:[0,(this.dataRangeOption.max-e)/(this.dataRangeOption.max-this.dataRangeOption.min)*this._calculableLocation.height],this._indicatorShape.style.text=this._textFormat(t.value),this._indicatorShape.style.color=this.getColor(e),this.zr.addHoverShape(this._indicatorShape)}},_textFormat:function(t,e){var i=this.dataRangeOption;if(t!==-Number.MAX_VALUE&&(t=(+t).toFixed(i.precision)),null!=e&&e!==Number.MAX_VALUE&&(e=(+e).toFixed(i.precision)),i.formatter){if("string"==typeof i.formatter)return i.formatter.replace("{value}",t===-Number.MAX_VALUE?"min":t).replace("{value2}",e===Number.MAX_VALUE?"max":e);if("function"==typeof i.formatter)return i.formatter.call(this.myChart,t,e)}return null==e?t:t===-Number.MAX_VALUE?"< "+e:e===Number.MAX_VALUE?"> "+t:t+" - "+e},_isContinuity:function(){var t=this.dataRangeOption;return!(t.splitList?t.splitList.length>0:t.splitNumber>0)||t.calculable},_useCustomizedSplit:function(){var t=this.dataRangeOption;return t.splitList&&t.splitList.length>0},_buildColorList:function(t){if(this._colorList=d.getGradientColors(this.dataRangeOption.color,Math.max((t-this.dataRangeOption.color.length)/(this.dataRangeOption.color.length-1),0)+1),this._colorList.length>t){for(var e=this._colorList.length,i=[this._colorList[0]],a=e/(t-1),s=1;t-1>s;s++)i.push(this._colorList[Math.floor(s*a)]);i.push(this._colorList[e-1]),this._colorList=i}if(this._useCustomizedSplit())for(var h=this._splitList,s=0,e=h.length;e>s;s++)h[s].color&&(this._colorList[s]=h[s].color)},_buildGap:function(t){if(!this._useCustomizedSplit()){var e=this.dataRangeOption.precision;for(this._gap=(this.dataRangeOption.max-this.dataRangeOption.min)/t;this._gap.toFixed(e)-0!=this._gap&&5>e;)e++;this.dataRangeOption.precision=e,this._gap=((this.dataRangeOption.max-this.dataRangeOption.min)/t).toFixed(e)-0}},_buildDataList:function(t){for(var e=this._valueTextList=[],i=this.dataRangeOption,a=this._useCustomizedSplit(),s=0;t>s;s++){this._selectedMap[s]=!0;var h="";if(a){var n=this._splitList[t-1-s];h=null!=n.label?n.label:null!=n.single?this._textFormat(n.single):this._textFormat(n.min,n.max)}else h=this._textFormat(s*this._gap+i.min,(s+1)*this._gap+i.min);e.unshift(h)}},_buildSplitList:function(){if(this._useCustomizedSplit())for(var t=this.dataRangeOption.splitList,e=this._splitList=[],i=0,a=t.length;a>i;i++){var s=t[i];if(!s||null==s.start&&null==s.end)throw new Error("Empty item exists in splitList!");var h={label:s.label,color:s.color};h.min=s.start,h.max=s.end,h.min>h.max&&(h.min=[h.max,h.max=h.min][0]),h.min===h.max&&(h.single=h.max),null==h.min&&(h.min=-Number.MAX_VALUE),null==h.max&&(h.max=Number.MAX_VALUE),e.push(h)}},refresh:function(t){if(t){this.option=t,this.option.dataRange=this.reformOption(this.option.dataRange);var e=this.dataRangeOption=this.option.dataRange;if(!this._useCustomizedSplit()&&(null==e.min||null==e.max))throw new Error("option.dataRange.min or option.dataRange.max has not been defined.");this.myChart.canvasSupported||(e.realtime=!1);var i=this._isContinuity()?100:this._useCustomizedSplit()?e.splitList.length:e.splitNumber;this._buildSplitList(),this._buildColorList(i),this._buildGap(i),this._buildDataList(i)}this.clear(),this._buildShape()},getColor:function(t){if(isNaN(t))return null;var e;if(this._useCustomizedSplit()){for(var i=this._splitList,a=0,s=i.length;s>a;a++)if(i[a].min<=t&&i[a].max>=t){e=a;break}}else{if(this.dataRangeOption.min==this.dataRangeOption.max)return this._colorList[0];if(t<this.dataRangeOption.min?t=this.dataRangeOption.min:t>this.dataRangeOption.max&&(t=this.dataRangeOption.max),this.dataRangeOption.calculable&&(t-(this._gap*this._range.start+this.dataRangeOption.min)>5e-5||t-(this._gap*this._range.end+this.dataRangeOption.min)<-5e-5))return null;(e=this._colorList.length-Math.ceil((t-this.dataRangeOption.min)/(this.dataRangeOption.max-this.dataRangeOption.min)*this._colorList.length))==this._colorList.length&&e--}return this._selectedMap[e]?this._colorList[e]:null},getColorByIndex:function(t){return t>=this._colorList.length?t=this._colorList.length-1:0>t&&(t=0),this._colorList[t]},onbeforDispose:function(){this.messageCenter.unbind(n.EVENT.HOVER,this._onhoverlink)}},o.inherits(e,i),t("../component").define("dataRange",e),e}),define("echarts/util/shape/HandlePolygon",["require","zrender/shape/Base","zrender/shape/Polygon","zrender/tool/util"],function(t){function e(t){i.call(this,t)}var i=t("zrender/shape/Base"),a=t("zrender/shape/Polygon"),s=t("zrender/tool/util");return e.prototype={type:"handle-polygon",buildPath:function(t,e){a.prototype.buildPath(t,e)},isCover:function(t,e){var i=this.transformCoordToLocal(t,e);t=i[0],e=i[1];var a=this.style.rect;return t>=a.x&&t<=a.x+a.width&&e>=a.y&&e<=a.y+a.height}},s.inherits(e,i),e});