define("echarts/chart/venn",["require","./base","zrender/shape/Text","zrender/shape/Circle","zrender/shape/Path","../config","../util/ecData","zrender/tool/util","../chart"],function(e){function t(e,t,s,i,r){a.call(this,e,t,s,i,r),this.refresh(i)}var a=e("./base"),s=e("zrender/shape/Text"),i=e("zrender/shape/Circle"),r=e("zrender/shape/Path"),h=e("../config");h.venn={zlevel:0,z:1,calculable:!1};var l=e("../util/ecData"),n=e("zrender/tool/util");return t.prototype={type:h.CHART_TYPE_VENN,_buildShape:function(){this.selectedMap={},this._symbol=this.option.symbolList,this._queryTarget,this._dropBoxList=[],this._vennDataCounter=0;for(var e=this.series,t=this.component.legend,a=0;a<e.length;a++)if(e[a].type===h.CHART_TYPE_VENN){e[a]=this.reformOption(e[a]);var s=e[a].name||"";if(this.selectedMap[s]=!t||t.isSelected(s),!this.selectedMap[s])continue;this._buildVenn(a)}this.addShapeList()},_buildVenn:function(e){var t,a,s=this.series[e],i=s.data;i[0].value>i[1].value?(t=this.zr.getHeight()/3,a=t*Math.sqrt(i[1].value)/Math.sqrt(i[0].value)):(a=this.zr.getHeight()/3,t=a*Math.sqrt(i[0].value)/Math.sqrt(i[1].value));var r=this.zr.getWidth()/2-t,h=(t+a)/2*Math.sqrt(i[2].value)/Math.sqrt((i[0].value+i[1].value)/2),l=t+a;0!==i[2].value&&(l=this._getCoincideLength(i[0].value,i[1].value,i[2].value,t,a,h,Math.abs(t-a),t+a));var n=r+l,o=this.zr.getHeight()/2;if(this._buildItem(e,0,i[0],r,o,t),this._buildItem(e,1,i[1],n,o,a),0!==i[2].value&&i[2].value!==i[0].value&&i[2].value!==i[1].value){var c=(t*t-a*a)/(2*l)+l/2,u=l/2-(t*t-a*a)/(2*l),p=Math.sqrt(t*t-c*c),f=0,v=0;i[0].value>i[1].value&&r+c>n&&(v=1),i[0].value<i[1].value&&r+u>n&&(f=1),this._buildCoincideItem(e,2,i[2],r+c,o-p,o+p,t,a,f,v)}},_getCoincideLength:function(e,t,a,s,i,r,h,l){var n=(s*s-i*i)/(2*r)+r/2,o=r/2-(s*s-i*i)/(2*r),c=Math.acos(n/s),u=Math.acos(o/i),p=s*s*Math.PI,f=c*s*s-n*s*Math.sin(c)+u*i*i-o*i*Math.sin(u),v=f/p,b=a/e,d=Math.abs(v/b);return d>.999&&1.001>d?r:.999>=d?(l=r,r=(r+h)/2,this._getCoincideLength(e,t,a,s,i,r,h,l)):(h=r,r=(r+l)/2,this._getCoincideLength(e,t,a,s,i,r,h,l))},_buildItem:function(e,t,a,s,i,r){var h=this.series,n=h[e],o=this.getCircle(e,t,a,s,i,r);if(l.pack(o,n,e,a,t,a.name),this.shapeList.push(o),n.itemStyle.normal.label.show){var c=this.getLabel(e,t,a,s,i,r);l.pack(c,n,e,n.data[t],t,n.data[t].name),this.shapeList.push(c)}},_buildCoincideItem:function(e,t,a,s,i,h,n,o,c,u){var p=this.series,f=p[e],v=[a,f],b=this.deepMerge(v,"itemStyle.normal")||{},d=this.deepMerge(v,"itemStyle.emphasis")||{},g=b.color||this.zr.getColor(t),m=d.color||this.zr.getColor(t),M="M"+s+","+i+"A"+n+","+n+",0,"+c+",1,"+s+","+h+"A"+o+","+o+",0,"+u+",1,"+s+","+i,y={color:g,path:M},z={zlevel:f.zlevel,z:f.z,style:y,highlightStyle:{color:m,lineWidth:d.borderWidth,strokeColor:d.borderColor}};z=new r(z),z.buildPathArray&&(z.style.pathArray=z.buildPathArray(y.path)),l.pack(z,p[e],0,a,t,a.name),this.shapeList.push(z)},getCircle:function(e,t,a,s,r,h){var l=this.series[e],n=[a,l],o=this.deepMerge(n,"itemStyle.normal")||{},c=this.deepMerge(n,"itemStyle.emphasis")||{},u=o.color||this.zr.getColor(t),p=c.color||this.zr.getColor(t),f={zlevel:l.zlevel,z:l.z,clickable:!0,style:{x:s,y:r,r:h,brushType:"fill",opacity:1,color:u},highlightStyle:{color:p,lineWidth:c.borderWidth,strokeColor:c.borderColor}};return this.deepQuery([a,l,this.option],"calculable")&&(this.setCalculable(f),f.draggable=!0),new i(f)},getLabel:function(e,t,a,i,r,h){var l=this.series[e],n=l.itemStyle,o=[a,l],c=this.deepMerge(o,"itemStyle.normal")||{},u="normal",p=n[u].label,f=p.textStyle||{},v=this.getLabelText(t,a,u),b=this.getFont(f),d=c.color||this.zr.getColor(t),g=f.fontSize||12,m={zlevel:l.zlevel,z:l.z,style:{x:i,y:r-h-g,color:f.color||d,text:v,textFont:b,textAlign:"center"}};return new s(m)},getLabelText:function(e,t,a){var s=this.series,i=s[0],r=this.deepQuery([t,i],"itemStyle."+a+".label.formatter");return r?"function"==typeof r?r(i.name,t.name,t.value):"string"==typeof r?(r=r.replace("{a}","{a0}").replace("{b}","{b0}").replace("{c}","{c0}"),r=r.replace("{a0}",i.name).replace("{b0}",t.name).replace("{c0}",t.value)):void 0:t.name},refresh:function(e){e&&(this.option=e,this.series=e.series),this._buildShape()}},n.inherits(t,a),e("../chart").define("venn",t),t}),define("zrender/shape/Path",["require","./Base","./util/PathProxy","../tool/util"],function(e){var t=e("./Base"),a=e("./util/PathProxy"),s=a.PathSegment,i=function(e){return Math.sqrt(e[0]*e[0]+e[1]*e[1])},r=function(e,t){return(e[0]*t[0]+e[1]*t[1])/(i(e)*i(t))},h=function(e,t){return(e[0]*t[1]<e[1]*t[0]?-1:1)*Math.acos(r(e,t))},l=function(e){t.call(this,e)};return l.prototype={type:"path",buildPathArray:function(e,t,a){if(!e)return[];t=t||0,a=a||0;var i=e,r=["m","M","l","L","v","V","h","H","z","Z","c","C","q","Q","t","T","s","S","a","A"];i=i.replace(/-/g," -"),i=i.replace(/  /g," "),i=i.replace(/ /g,","),i=i.replace(/,,/g,",");var h;for(h=0;h<r.length;h++)i=i.replace(new RegExp(r[h],"g"),"|"+r[h]);var l=i.split("|"),n=[],o=0,c=0;for(h=1;h<l.length;h++){var u=l[h],p=u.charAt(0);u=u.slice(1),u=u.replace(new RegExp("e,-","g"),"e-");var f=u.split(",");f.length>0&&""===f[0]&&f.shift();for(var v=0;v<f.length;v++)f[v]=parseFloat(f[v]);for(;f.length>0&&!isNaN(f[0]);){var b,d,g,m,M,y,z,_,C=null,A=[],L=o,k=c;switch(p){case"l":o+=f.shift(),c+=f.shift(),C="L",A.push(o,c);break;case"L":o=f.shift(),c=f.shift(),A.push(o,c);break;case"m":o+=f.shift(),c+=f.shift(),C="M",A.push(o,c),p="l";break;case"M":o=f.shift(),c=f.shift(),C="M",A.push(o,c),p="L";break;case"h":o+=f.shift(),C="L",A.push(o,c);break;case"H":o=f.shift(),C="L",A.push(o,c);break;case"v":c+=f.shift(),C="L",A.push(o,c);break;case"V":c=f.shift(),C="L",A.push(o,c);break;case"C":A.push(f.shift(),f.shift(),f.shift(),f.shift()),o=f.shift(),c=f.shift(),A.push(o,c);break;case"c":A.push(o+f.shift(),c+f.shift(),o+f.shift(),c+f.shift()),o+=f.shift(),c+=f.shift(),C="C",A.push(o,c);break;case"S":b=o,d=c,g=n[n.length-1],"C"===g.command&&(b=o+(o-g.points[2]),d=c+(c-g.points[3])),A.push(b,d,f.shift(),f.shift()),o=f.shift(),c=f.shift(),C="C",A.push(o,c);break;case"s":b=o,d=c,g=n[n.length-1],"C"===g.command&&(b=o+(o-g.points[2]),d=c+(c-g.points[3])),A.push(b,d,o+f.shift(),c+f.shift()),o+=f.shift(),c+=f.shift(),C="C",A.push(o,c);break;case"Q":A.push(f.shift(),f.shift()),o=f.shift(),c=f.shift(),A.push(o,c);break;case"q":A.push(o+f.shift(),c+f.shift()),o+=f.shift(),c+=f.shift(),C="Q",A.push(o,c);break;case"T":b=o,d=c,g=n[n.length-1],"Q"===g.command&&(b=o+(o-g.points[0]),d=c+(c-g.points[1])),o=f.shift(),c=f.shift(),C="Q",A.push(b,d,o,c);break;case"t":b=o,d=c,g=n[n.length-1],"Q"===g.command&&(b=o+(o-g.points[0]),d=c+(c-g.points[1])),o+=f.shift(),c+=f.shift(),C="Q",A.push(b,d,o,c);break;case"A":m=f.shift(),M=f.shift(),y=f.shift(),z=f.shift(),_=f.shift(),L=o,k=c,o=f.shift(),c=f.shift(),C="A",A=this._convertPoint(L,k,o,c,z,_,m,M,y);break;case"a":m=f.shift(),M=f.shift(),y=f.shift(),z=f.shift(),_=f.shift(),L=o,k=c,o+=f.shift(),c+=f.shift(),C="A",A=this._convertPoint(L,k,o,c,z,_,m,M,y)}for(var P=0,N=A.length;N>P;P+=2)A[P]+=t,A[P+1]+=a;n.push(new s(C||p,A))}("z"===p||"Z"===p)&&n.push(new s("z",[]))}return n},_convertPoint:function(e,t,a,s,i,l,n,o,c){var u=c*(Math.PI/180),p=Math.cos(u)*(e-a)/2+Math.sin(u)*(t-s)/2,f=-1*Math.sin(u)*(e-a)/2+Math.cos(u)*(t-s)/2,v=p*p/(n*n)+f*f/(o*o);v>1&&(n*=Math.sqrt(v),o*=Math.sqrt(v));var b=Math.sqrt((n*n*o*o-n*n*f*f-o*o*p*p)/(n*n*f*f+o*o*p*p));i===l&&(b*=-1),isNaN(b)&&(b=0);var d=b*n*f/o,g=b*-o*p/n,m=(e+a)/2+Math.cos(u)*d-Math.sin(u)*g,M=(t+s)/2+Math.sin(u)*d+Math.cos(u)*g,y=h([1,0],[(p-d)/n,(f-g)/o]),z=[(p-d)/n,(f-g)/o],_=[(-1*p-d)/n,(-1*f-g)/o],C=h(z,_);return r(z,_)<=-1&&(C=Math.PI),r(z,_)>=1&&(C=0),0===l&&C>0&&(C-=2*Math.PI),1===l&&0>C&&(C+=2*Math.PI),[m,M,n,o,y,C,u,l]},buildPath:function(e,t){var a=t.path,s=t.x||0,i=t.y||0;t.pathArray=t.pathArray||this.buildPathArray(a,s,i);for(var r=t.pathArray,h=t.pointList=[],l=[],n=0,o=r.length;o>n;n++){"M"==r[n].command.toUpperCase()&&(l.length>0&&h.push(l),l=[]);for(var c=r[n].points,u=0,p=c.length;p>u;u+=2)l.push([c[u],c[u+1]])}l.length>0&&h.push(l);for(var n=0,o=r.length;o>n;n++){var f=r[n].command,c=r[n].points;switch(f){case"L":e.lineTo(c[0],c[1]);break;case"M":e.moveTo(c[0],c[1]);break;case"C":e.bezierCurveTo(c[0],c[1],c[2],c[3],c[4],c[5]);break;case"Q":e.quadraticCurveTo(c[0],c[1],c[2],c[3]);break;case"A":var v=c[0],b=c[1],d=c[2],g=c[3],m=c[4],M=c[5],y=c[6],z=c[7],_=d>g?d:g,C=d>g?1:d/g,A=d>g?g/d:1;e.translate(v,b),e.rotate(y),e.scale(C,A),e.arc(0,0,_,m,m+M,1-z),e.scale(1/C,1/A),e.rotate(-y),e.translate(-v,-b);break;case"z":e.closePath()}}},getRect:function(e){if(e.__rect)return e.__rect;var t;t="stroke"==e.brushType||"fill"==e.brushType?e.lineWidth||1:0;for(var a=Number.MAX_VALUE,s=Number.MIN_VALUE,i=Number.MAX_VALUE,r=Number.MIN_VALUE,h=e.x||0,l=e.y||0,n=e.pathArray||this.buildPathArray(e.path),o=0;o<n.length;o++)for(var c=n[o].points,u=0;u<c.length;u++)u%2==0?(c[u]+h<a&&(a=c[u]),c[u]+h>s&&(s=c[u])):(c[u]+l<i&&(i=c[u]),c[u]+l>r&&(r=c[u]));var p;return p=a===Number.MAX_VALUE||s===Number.MIN_VALUE||i===Number.MAX_VALUE||r===Number.MIN_VALUE?{x:0,y:0,width:0,height:0}:{x:Math.round(a-t/2),y:Math.round(i-t/2),width:s-a+t,height:r-i+t},e.__rect=p,p}},e("../tool/util").inherits(l,t),l});