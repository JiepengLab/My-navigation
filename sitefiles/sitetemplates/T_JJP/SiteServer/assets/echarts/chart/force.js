define("echarts/chart/force",["require","./base","../data/Graph","../layout/Force","zrender/shape/Line","zrender/shape/BezierCurve","zrender/shape/Image","../util/shape/Icon","../config","../util/ecData","zrender/tool/util","zrender/config","zrender/tool/vector","../chart"],function(e){"use strict";function t(e,t,r,d,l){var p=this;a.call(this,e,t,r,d,l),this.__nodePositionMap={},this._graph=new n(!0),this._layout=new h,this._layout.onupdate=function(){p._step()},this._steps=1,this.ondragstart=function(){i.apply(p,arguments)},this.ondragend=function(){s.apply(p,arguments)},this.ondrop=function(){},this.shapeHandler.ondragstart=function(){p.isDragstart=!0},this.onmousemove=function(){o.apply(p,arguments)},this.refresh(d)}function i(e){if(this.isDragstart&&e.target){e.target.fixed=!0,this.isDragstart=!1,this.zr.on(y.EVENT.MOUSEMOVE,this.onmousemove)}}function o(){this._layout.temperature=.8,this._step()}function s(e,t){if(this.isDragend&&e.target){e.target.fixed=!1,t.dragIn=!0,t.needRefresh=!1,this.isDragend=!1,this.zr.un(y.EVENT.MOUSEMOVE,this.onmousemove)}}function r(e,t,i){var o=v.create();return o[0]=(Math.random()-.5)*i+e,o[1]=(Math.random()-.5)*i+t,o}var a=e("./base"),n=e("../data/Graph"),h=e("../layout/Force"),d=e("zrender/shape/Line"),l=e("zrender/shape/BezierCurve"),p=e("zrender/shape/Image"),u=e("../util/shape/Icon"),c=e("../config");c.force={zlevel:1,z:2,center:["50%","50%"],size:"100%",preventOverlap:!1,coolDown:.99,minRadius:10,maxRadius:20,ratioScaling:!1,large:!1,useWorker:!1,steps:1,scaling:1,gravity:1,symbol:"circle",symbolSize:0,linkSymbol:null,linkSymbolSize:[10,15],draggable:!0,clickable:!0,roam:!1,itemStyle:{normal:{label:{show:!1,position:"inside"},nodeStyle:{brushType:"both",borderColor:"#5182ab",borderWidth:1},linkStyle:{color:"#5182ab",width:1,type:"line"}},emphasis:{label:{show:!1},nodeStyle:{},linkStyle:{opacity:0}}}};var g=e("../util/ecData"),f=e("zrender/tool/util"),y=e("zrender/config"),v=e("zrender/tool/vector");return t.prototype={constructor:t,type:c.CHART_TYPE_FORCE,_init:function(){this.selectedMap={};var e,t=this.component.legend,i=this.series;this.clear();for(var o=0,s=i.length;s>o;o++){var r=i[o];if(r.type===c.CHART_TYPE_FORCE){if(i[o]=this.reformOption(i[o]),e=i[o].name||"",this.selectedMap[e]=!t||t.isSelected(e),!this.selectedMap[e])continue;this.buildMark(o),this._initSerie(r,o);break}}this.animationEffect()},_getNodeCategory:function(e,t){return e.categories&&e.categories[t.category||0]},_getNodeQueryTarget:function(e,t,i){i=i||"normal";var o=this._getNodeCategory(e,t)||{};return[t.itemStyle&&t.itemStyle[i],o&&o.itemStyle&&o.itemStyle[i],e.itemStyle[i].nodeStyle]},_getEdgeQueryTarget:function(e,t,i){return i=i||"normal",[t.itemStyle&&t.itemStyle[i],e.itemStyle[i].linkStyle]},_initSerie:function(e,t){this._temperature=1,e.matrix?this._graph=this._getSerieGraphFromDataMatrix(e):e.links&&(this._graph=this._getSerieGraphFromNodeLinks(e)),this._buildLinkShapes(e,t),this._buildNodeShapes(e,t);var i=!0===e.roam||"move"===e.roam,o=!0===e.roam||"scale"===e.roam;this.zr.modLayer(this.getZlevelBase(),{panable:i,zoomable:o}),(this.query("markPoint.effect.show")||this.query("markLine.effect.show"))&&this.zr.modLayer(c.EFFECT_ZLEVEL,{panable:i,zoomable:o}),this._initLayout(e),this._step()},_getSerieGraphFromDataMatrix:function(e){for(var t=[],i=0,o=[],s=0;s<e.matrix.length;s++)o[s]=e.matrix[s].slice();for(var r=e.data||e.nodes,s=0;s<r.length;s++){var a={},h=r[s];for(var d in h)"name"===d?a.id=h.name:a[d]=h[d];var l=this._getNodeCategory(e,h),p=l?l.name:h.name;if(this.selectedMap[p]=this.isSelected(p),this.selectedMap[p])t.push(a),i++;else{o.splice(i,1);for(var u=0;u<o.length;u++)o[u].splice(i,1)}}var c=n.fromMatrix(t,o,!0);return c.eachNode(function(e,t){e.layout={size:e.data.value,mass:0},e.rawIndex=t}),c.eachEdge(function(e){e.layout={weight:e.data.weight}}),c},_getSerieGraphFromNodeLinks:function(e){for(var t=new n(!0),i=e.data||e.nodes,o=0,s=i.length;s>o;o++){var r=i[o];if(r&&!r.ignore){var a=this._getNodeCategory(e,r),h=a?a.name:r.name;if(this.selectedMap[h]=this.isSelected(h),this.selectedMap[h]){t.addNode(r.name,r).rawIndex=o}}}for(var o=0,s=e.links.length;s>o;o++){var d=e.links[o],l=d.source,p=d.target;"number"==typeof l&&(l=i[l])&&(l=l.name),"number"==typeof p&&(p=i[p])&&(p=p.name);var u=t.addEdge(l,p,d);u&&(u.rawIndex=o)}return t.eachNode(function(e){var t=e.data.value;if(null==t){t=0;for(var i=0;i<e.edges.length;i++)t+=e.edges[i].data.weight||0}e.layout={size:t,mass:0}}),t.eachEdge(function(e){e.layout={weight:null==e.data.weight?1:e.data.weight}}),t},_initLayout:function(e){var t=this._graph,i=t.nodes.length,o=this.query(e,"minRadius"),s=this.query(e,"maxRadius");this._steps=e.steps||1;var a=this._layout;a.center=this.parseCenter(this.zr,e.center),a.width=this.parsePercent(e.size,this.zr.getWidth()),a.height=this.parsePercent(e.size,this.zr.getHeight()),a.large=e.large,a.scaling=e.scaling,a.ratioScaling=e.ratioScaling,a.gravity=e.gravity,a.temperature=1,a.coolDown=e.coolDown,a.preventNodeEdgeOverlap=e.preventOverlap,a.preventNodeOverlap=e.preventOverlap;for(var n=1/0,h=-1/0,d=0;i>d;d++){var l=t.nodes[d];h=Math.max(l.layout.size,h),n=Math.min(l.layout.size,n)}for(var p=h-n,d=0;i>d;d++){var l=t.nodes[d];p>0?(l.layout.size=(l.layout.size-n)*(s-o)/p+o,l.layout.mass=l.layout.size/s):(l.layout.size=(s-o)/2,l.layout.mass=.5)}for(var d=0;i>d;d++){var l=t.nodes[d];if(void 0!==this.__nodePositionMap[l.id])l.layout.position=v.create(),v.copy(l.layout.position,this.__nodePositionMap[l.id]);else if(void 0!==l.data.initial)l.layout.position=v.create(),v.copy(l.layout.position,l.data.initial);else{var u=this._layout.center,c=Math.min(this._layout.width,this._layout.height);l.layout.position=r(u[0],u[1],.8*c)}var g=l.shape.style,f=l.layout.size;g.width=g.width||2*f,g.height=g.height||2*f,g.x=-g.width/2,g.y=-g.height/2,v.copy(l.shape.position,l.layout.position)}i=t.edges.length,h=-1/0;for(var d=0;i>d;d++){var y=t.edges[d];y.layout.weight>h&&(h=y.layout.weight)}for(var d=0;i>d;d++){var y=t.edges[d];y.layout.weight/=h}this._layout.init(t,e.useWorker)},_buildNodeShapes:function(e,t){var i=this._graph,o=this.query(e,"categories");i.eachNode(function(i){var s=this._getNodeCategory(e,i.data),r=[i.data,s,e],a=this._getNodeQueryTarget(e,i.data),n=this._getNodeQueryTarget(e,i.data,"emphasis"),h=new u({style:{x:0,y:0,color:this.deepQuery(a,"color"),brushType:"both",strokeColor:this.deepQuery(a,"strokeColor")||this.deepQuery(a,"borderColor"),lineWidth:this.deepQuery(a,"lineWidth")||this.deepQuery(a,"borderWidth")},highlightStyle:{color:this.deepQuery(n,"color"),strokeColor:this.deepQuery(n,"strokeColor")||this.deepQuery(n,"borderColor"),lineWidth:this.deepQuery(n,"lineWidth")||this.deepQuery(n,"borderWidth")},clickable:e.clickable,zlevel:this.getZlevelBase(),z:this.getZBase()});h.style.color||(h.style.color=this.getColor(s?s.name:i.id)),h.style.iconType=this.deepQuery(r,"symbol");var d=this.deepQuery(r,"symbolSize")||0;"number"==typeof d&&(d=[d,d]),h.style.width=2*d[0],h.style.height=2*d[1],h.style.iconType.match("image")&&(h.style.image=h.style.iconType.replace(new RegExp("^image:\\/\\/"),""),h=new p({style:h.style,highlightStyle:h.highlightStyle,clickable:h.clickable,zlevel:this.getZlevelBase(),z:this.getZBase()})),this.deepQuery(r,"itemStyle.normal.label.show")&&(h.style.text=null==i.data.label?i.id:i.data.label,h.style.textPosition=this.deepQuery(r,"itemStyle.normal.label.position"),h.style.textColor=this.deepQuery(r,"itemStyle.normal.label.textStyle.color"),h.style.textFont=this.getFont(this.deepQuery(r,"itemStyle.normal.label.textStyle")||{})),this.deepQuery(r,"itemStyle.emphasis.label.show")&&(h.highlightStyle.textPosition=this.deepQuery(r,"itemStyle.emphasis.label.position"),h.highlightStyle.textColor=this.deepQuery(r,"itemStyle.emphasis.label.textStyle.color"),h.highlightStyle.textFont=this.getFont(this.deepQuery(r,"itemStyle.emphasis.label.textStyle")||{})),this.deepQuery(r,"draggable")&&(this.setCalculable(h),h.dragEnableTime=0,h.draggable=!0,h.ondragstart=this.shapeHandler.ondragstart,h.ondragover=null);if(void 0!==i.category){var s=o[i.category];s&&s.name||""}g.pack(h,e,t,i.data,i.rawIndex,i.data.name||"",i.category),this.shapeList.push(h),this.zr.addShape(h),i.shape=h},this)},_buildLinkShapes:function(e,t){for(var i=this._graph,o=i.edges.length,s=0;o>s;s++){var r=i.edges[s],a=r.data,n=r.node1,h=r.node2,p=i.getEdge(h,n),c=this._getEdgeQueryTarget(e,a),y=this.deepQuery(c,"type");e.linkSymbol&&"none"!==e.linkSymbol&&(y="line");var v="line"===y?d:l,m=new v({style:{xStart:0,yStart:0,xEnd:0,yEnd:0},clickable:this.query(e,"clickable"),highlightStyle:{},zlevel:this.getZlevelBase(),z:this.getZBase()});if(p&&p.shape&&(m.style.offset=4,p.shape.style.offset=4),f.merge(m.style,this.query(e,"itemStyle.normal.linkStyle"),!0),f.merge(m.highlightStyle,this.query(e,"itemStyle.emphasis.linkStyle"),!0),void 0!==a.itemStyle&&(a.itemStyle.normal&&f.merge(m.style,a.itemStyle.normal,!0),a.itemStyle.emphasis&&f.merge(m.highlightStyle,a.itemStyle.emphasis,!0)),m.style.lineWidth=m.style.lineWidth||m.style.width,m.style.strokeColor=m.style.strokeColor||m.style.color,m.highlightStyle.lineWidth=m.highlightStyle.lineWidth||m.highlightStyle.width,m.highlightStyle.strokeColor=m.highlightStyle.strokeColor||m.highlightStyle.color,g.pack(m,e,t,r.data,null==r.rawIndex?s:r.rawIndex,r.data.name||n.id+" - "+h.id,n.id,h.id),this.shapeList.push(m),this.zr.addShape(m),r.shape=m,e.linkSymbol&&"none"!==e.linkSymbol){var _=new u({style:{x:-5,y:0,width:e.linkSymbolSize[0],height:e.linkSymbolSize[1],iconType:e.linkSymbol,brushType:"fill",color:m.style.strokeColor},highlightStyle:{brushType:"fill"},position:[0,0],rotation:0,zlevel:this.getZlevelBase(),z:this.getZBase()});m._symbolShape=_,this.shapeList.push(_),this.zr.addShape(_)}}},_updateLinkShapes:function(){for(var e=v.create(),t=v.create(),i=v.create(),o=v.create(),s=this._graph.edges,r=0,a=s.length;a>r;r++){var n=s[r],h=n.node1.shape,d=n.node2.shape;v.copy(i,h.position),v.copy(o,d.position);var l=n.shape.style;if(v.sub(e,i,o),v.normalize(e,e),l.offset?(t[0]=e[1],t[1]=-e[0],v.scaleAndAdd(i,i,t,l.offset),v.scaleAndAdd(o,o,t,l.offset)):"bezier-curve"===n.shape.type&&(l.cpX1=(i[0]+o[0])/2-(o[1]-i[1])/4,l.cpY1=(i[1]+o[1])/2-(i[0]-o[0])/4),l.xStart=i[0],l.yStart=i[1],l.xEnd=o[0],l.yEnd=o[1],n.shape.modSelf(),n.shape._symbolShape){var p=n.shape._symbolShape;v.copy(p.position,o),v.scaleAndAdd(p.position,p.position,e,d.style.width/2+2);var u=Math.atan2(e[1],e[0]);p.rotation=Math.PI/2-u,p.modSelf()}}},_syncNodePositions:function(){for(var e=this._graph,t=0;t<e.nodes.length;t++){var i=e.nodes[t],o=i.layout.position,s=i.data,r=i.shape,a=r.fixed||s.fixX,n=r.fixed||s.fixY;!0===a?a=1:isNaN(a)&&(a=0),!0===n?n=1:isNaN(n)&&(n=0),r.position[0]+=(o[0]-r.position[0])*(1-a),r.position[1]+=(o[1]-r.position[1])*(1-n),v.copy(o,r.position);var h=s.name;if(h){var d=this.__nodePositionMap[h];d||(d=this.__nodePositionMap[h]=v.create()),v.copy(d,o)}r.modSelf()}},_step:function(){this._syncNodePositions(),this._updateLinkShapes(),this.zr.refreshNextFrame(),this._layout.temperature>.01?this._layout.step(this._steps):this.messageCenter.dispatch(c.EVENT.FORCE_LAYOUT_END,{},{},this.myChart)},refresh:function(e){if(e&&(this.option=e,this.series=this.option.series),this.legend=this.component.legend,this.legend)this.getColor=function(e){return this.legend.getColor(e)},this.isSelected=function(e){return this.legend.isSelected(e)};else{var t={},i=0;this.getColor=function(e){return t[e]?t[e]:(t[e]||(t[e]=this.zr.getColor(i++)),t[e])},this.isSelected=function(){return!0}}this._init()},dispose:function(){this.clear(),this.shapeList=null,this.effectList=null,this._layout.dispose(),this._layout=null,this.__nodePositionMap={}},getPosition:function(){var e=[];return this._graph.eachNode(function(t){t.layout&&e.push({name:t.data.name,position:Array.prototype.slice.call(t.layout.position)})}),e}},f.inherits(t,a),e("../chart").define("force",t),t}),define("echarts/data/Graph",["require","zrender/tool/util"],function(e){var t=e("zrender/tool/util"),i=function(e){this._directed=e||!1,this.nodes=[],this.edges=[],this._nodesMap={},this._edgesMap={}};i.prototype.isDirected=function(){return this._directed},i.prototype.addNode=function(e,t){if(this._nodesMap[e])return this._nodesMap[e];var o=new i.Node(e,t);return this.nodes.push(o),this._nodesMap[e]=o,o},i.prototype.getNodeById=function(e){return this._nodesMap[e]},i.prototype.addEdge=function(e,t,o){if("string"==typeof e&&(e=this._nodesMap[e]),"string"==typeof t&&(t=this._nodesMap[t]),e&&t){var s=e.id+"-"+t.id;if(this._edgesMap[s])return this._edgesMap[s];var r=new i.Edge(e,t,o);return this._directed&&(e.outEdges.push(r),t.inEdges.push(r)),e.edges.push(r),e!==t&&t.edges.push(r),this.edges.push(r),this._edgesMap[s]=r,r}},i.prototype.removeEdge=function(e){var i=e.node1,o=e.node2,s=i.id+"-"+o.id;this._directed&&(i.outEdges.splice(t.indexOf(i.outEdges,e),1),o.inEdges.splice(t.indexOf(o.inEdges,e),1)),i.edges.splice(t.indexOf(i.edges,e),1),i!==o&&o.edges.splice(t.indexOf(o.edges,e),1),delete this._edgesMap[s],this.edges.splice(t.indexOf(this.edges,e),1)},i.prototype.getEdge=function(e,t){return"string"!=typeof e&&(e=e.id),"string"!=typeof t&&(t=t.id),this._directed?this._edgesMap[e+"-"+t]:this._edgesMap[e+"-"+t]||this._edgesMap[t+"-"+e]},i.prototype.removeNode=function(e){if("string"!=typeof e||(e=this._nodesMap[e])){delete this._nodesMap[e.id],this.nodes.splice(t.indexOf(this.nodes,e),1);for(var i=0;i<this.edges.length;){var o=this.edges[i];o.node1===e||o.node2===e?this.removeEdge(o):i++}}},i.prototype.filterNode=function(e,t){for(var i=this.nodes.length,o=0;i>o;)e.call(t,this.nodes[o],o)?o++:(this.removeNode(this.nodes[o]),i--)},i.prototype.filterEdge=function(e,t){for(var i=this.edges.length,o=0;i>o;)e.call(t,this.edges[o],o)?o++:(this.removeEdge(this.edges[o]),i--)},i.prototype.eachNode=function(e,t){for(var i=this.nodes.length,o=0;i>o;o++)this.nodes[o]&&e.call(t,this.nodes[o],o)},i.prototype.eachEdge=function(e,t){for(var i=this.edges.length,o=0;i>o;o++)this.edges[o]&&e.call(t,this.edges[o],o)},i.prototype.clear=function(){this.nodes.length=0,this.edges.length=0,this._nodesMap={},this._edgesMap={}},i.prototype.breadthFirstTraverse=function(e,t,i,o){if("string"==typeof t&&(t=this._nodesMap[t]),t){var s="edges";"out"===i?s="outEdges":"in"===i&&(s="inEdges");for(var r=0;r<this.nodes.length;r++)this.nodes[r].__visited=!1;if(!e.call(o,t,null))for(var a=[t];a.length;)for(var n=a.shift(),h=n[s],r=0;r<h.length;r++){var d=h[r],l=d.node1===n?d.node2:d.node1;if(!l.__visited){if(e.call(l,l,n))return;a.push(l),l.__visited=!0}}}},i.prototype.clone=function(){for(var e=new i(this._directed),t=0;t<this.nodes.length;t++)e.addNode(this.nodes[t].id,this.nodes[t].data);for(var t=0;t<this.edges.length;t++){var o=this.edges[t];e.addEdge(o.node1.id,o.node2.id,o.data)}return e};var o=function(e,t){this.id=e,this.data=t||null,this.inEdges=[],this.outEdges=[],this.edges=[]};o.prototype.degree=function(){return this.edges.length},o.prototype.inDegree=function(){return this.inEdges.length},o.prototype.outDegree=function(){return this.outEdges.length};var s=function(e,t,i){this.node1=e,this.node2=t,this.data=i||null};return i.Node=o,i.Edge=s,i.fromMatrix=function(e,t,o){if(t&&t.length&&t[0].length===t.length&&e.length===t.length){for(var s=t.length,r=new i(o),a=0;s>a;a++){var n=r.addNode(e[a].id,e[a]);n.data.value=0,o&&(n.data.outValue=n.data.inValue=0)}for(var a=0;s>a;a++)for(var h=0;s>h;h++){var d=t[a][h];o&&(r.nodes[a].data.outValue+=d,r.nodes[h].data.inValue+=d),r.nodes[a].data.value+=d,r.nodes[h].data.value+=d}for(var a=0;s>a;a++)for(var h=a;s>h;h++){var d=t[a][h];if(0!==d){var l=r.nodes[a],p=r.nodes[h],u=r.addEdge(l,p,{});if(u.data.weight=d,a!==h&&o&&t[h][a]){var c=r.addEdge(p,l,{});c.data.weight=t[h][a]}}}return r}},i}),define("echarts/layout/Force",["require","./forceLayoutWorker","zrender/tool/vector"],function(e){function t(){if("undefined"!=typeof Worker&&"undefined"!=typeof Blob)try{var e=new Blob([o.getWorkerCode()]);i=window.URL.createObjectURL(e)}catch(e){i=""}return i}var i,o=e("./forceLayoutWorker"),s=e("zrender/tool/vector"),r=window.requestAnimationFrame||window.msRequestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||function(e){setTimeout(e,16)},a="undefined"==typeof Float32Array?Array:Float32Array,n=function(e){void 0===i&&t(),e=e||{},this.width=e.width||500,this.height=e.height||500,this.center=e.center||[this.width/2,this.height/2],this.ratioScaling=e.ratioScaling||!1,this.scaling=e.scaling||1,this.gravity=void 0!==e.gravity?e.gravity:1,this.large=e.large||!1,this.preventNodeOverlap=e.preventNodeOverlap||!1,this.preventNodeEdgeOverlap=e.preventNodeEdgeOverlap||!1,this.maxSpeedIncrease=e.maxSpeedIncrease||1,this.onupdate=e.onupdate||function(){},this.temperature=e.temperature||1,this.coolDown=e.coolDown||.99,this._layout=null,this._layoutWorker=null;var o=this,s=this._$onupdate;this._$onupdate=function(e){s.call(o,e)}};return n.prototype.updateConfig=function(){var e=this.width,t=this.height,i=Math.min(e,t),o={center:this.center,width:this.ratioScaling?e:i,height:this.ratioScaling?t:i,scaling:this.scaling||1,gravity:this.gravity||1,barnesHutOptimize:this.large,preventNodeOverlap:this.preventNodeOverlap,preventNodeEdgeOverlap:this.preventNodeEdgeOverlap,maxSpeedIncrease:this.maxSpeedIncrease};if(this._layoutWorker)this._layoutWorker.postMessage({cmd:"updateConfig",config:o});else for(var s in o)this._layout[s]=o[s]},n.prototype.init=function(e,t){if(this._layoutWorker&&(this._layoutWorker.terminate(),this._layoutWorker=null),i&&t)try{this._layoutWorker||(this._layoutWorker=new Worker(i),this._layoutWorker.onmessage=this._$onupdate),this._layout=null}catch(e){this._layoutWorker=null,this._layout||(this._layout=new o)}else this._layout||(this._layout=new o);this.temperature=1,this.graph=e;for(var s=e.nodes.length,r=new a(2*s),n=new a(s),h=new a(s),d=0;s>d;d++){var l=e.nodes[d];r[2*d]=l.layout.position[0],r[2*d+1]=l.layout.position[1],n[d]=void 0===l.layout.mass?1:l.layout.mass,h[d]=void 0===l.layout.size?1:l.layout.size,l.layout.__index=d}s=e.edges.length;for(var p=new a(2*s),u=new a(s),d=0;s>d;d++){var c=e.edges[d];p[2*d]=c.node1.layout.__index,p[2*d+1]=c.node2.layout.__index,u[d]=c.layout.weight||1}this._layoutWorker?this._layoutWorker.postMessage({cmd:"init",nodesPosition:r,nodesMass:n,nodesSize:h,edges:p,edgesWeight:u}):(this._layout.initNodes(r,n,h),this._layout.initEdges(p,u)),this.updateConfig()},n.prototype.step=function(e){var t=this.graph.nodes;if(this._layoutWorker){for(var i=new a(2*t.length),o=0;o<t.length;o++){var n=t[o];i[2*o]=n.layout.position[0],i[2*o+1]=n.layout.position[1]}this._layoutWorker.postMessage(i.buffer,[i.buffer]),this._layoutWorker.postMessage({cmd:"update",steps:e,temperature:this.temperature,coolDown:this.coolDown});for(var o=0;e>o;o++)this.temperature*=this.coolDown}else{r(this._$onupdate);for(var o=0;o<t.length;o++){var n=t[o];s.copy(this._layout.nodes[o].position,n.layout.position)}for(var o=0;e>o;o++)this._layout.temperature=this.temperature,this._layout.update(),this.temperature*=this.coolDown}},n.prototype._$onupdate=function(e){if(this._layoutWorker){for(var t=new Float32Array(e.data),i=0;i<this.graph.nodes.length;i++){var o=this.graph.nodes[i];o.layout.position[0]=t[2*i],o.layout.position[1]=t[2*i+1]}this.onupdate&&this.onupdate()}else if(this._layout){for(var i=0;i<this.graph.nodes.length;i++){var o=this.graph.nodes[i];s.copy(o.layout.position,this._layout.nodes[i].position)}this.onupdate&&this.onupdate()}},n.prototype.dispose=function(){this._layoutWorker&&this._layoutWorker.terminate(),this._layoutWorker=null,this._layout=null},n}),define("echarts/layout/forceLayoutWorker",["require","zrender/tool/vector"],function e(t){"use strict";function i(){this.subRegions=[],this.nSubRegions=0,this.node=null,this.mass=0,this.centerOfMass=null,this.bbox=new h(4),this.size=0}function o(){this.position=a.create(),this.force=a.create(),this.forcePrev=a.create(),this.speed=a.create(),this.speedPrev=a.create(),this.mass=1,this.inDegree=0,this.outDegree=0}function s(e,t){this.node1=e,this.node2=t,this.weight=1}function r(){this.barnesHutOptimize=!1,this.barnesHutTheta=1.5,this.repulsionByDegree=!1,this.preventNodeOverlap=!1,this.preventNodeEdgeOverlap=!1,this.strongGravity=!0,this.gravity=1,this.scaling=1,this.edgeWeightInfluence=1,this.center=[0,0],this.width=500,this.height=500,this.maxSpeedIncrease=1,this.nodes=[],this.edges=[],this.bbox=new h(4),this._rootRegion=new i,this._rootRegion.centerOfMass=a.create(),this._massArr=null,this._k=0}var a,n="undefined"==typeof window&&void 0===t;a=n?{create:function(e,t){var i=new Float32Array(2);return i[0]=e||0,i[1]=t||0,i},dist:function(e,t){var i=t[0]-e[0],o=t[1]-e[1];return Math.sqrt(i*i+o*o)},len:function(e){var t=e[0],i=e[1];return Math.sqrt(t*t+i*i)},scaleAndAdd:function(e,t,i,o){return e[0]=t[0]+i[0]*o,e[1]=t[1]+i[1]*o,e},scale:function(e,t,i){return e[0]=t[0]*i,e[1]=t[1]*i,e},add:function(e,t,i){return e[0]=t[0]+i[0],e[1]=t[1]+i[1],e},sub:function(e,t,i){return e[0]=t[0]-i[0],e[1]=t[1]-i[1],e},dot:function(e,t){return e[0]*t[0]+e[1]*t[1]},normalize:function(e,t){var i=t[0],o=t[1],s=i*i+o*o;return s>0&&(s=1/Math.sqrt(s),e[0]=t[0]*s,e[1]=t[1]*s),e},negate:function(e,t){return e[0]=-t[0],e[1]=-t[1],e},copy:function(e,t){return e[0]=t[0],e[1]=t[1],e},set:function(e,t,i){return e[0]=t,e[1]=i,e}}:t("zrender/tool/vector");var h="undefined"==typeof Float32Array?Array:Float32Array;if(i.prototype.beforeUpdate=function(){for(var e=0;e<this.nSubRegions;e++)this.subRegions[e].beforeUpdate();this.mass=0,this.centerOfMass&&(this.centerOfMass[0]=0,this.centerOfMass[1]=0),this.nSubRegions=0,this.node=null},i.prototype.afterUpdate=function(){this.subRegions.length=this.nSubRegions;for(var e=0;e<this.nSubRegions;e++)this.subRegions[e].afterUpdate()},i.prototype.addNode=function(e){if(0===this.nSubRegions){if(null==this.node)return void(this.node=e);this._addNodeToSubRegion(this.node),this.node=null}this._addNodeToSubRegion(e),this._updateCenterOfMass(e)},i.prototype.findSubRegion=function(e,t){for(var i=0;i<this.nSubRegions;i++){var o=this.subRegions[i];if(o.contain(e,t))return o}},i.prototype.contain=function(e,t){return this.bbox[0]<=e&&this.bbox[2]>=e&&this.bbox[1]<=t&&this.bbox[3]>=t},i.prototype.setBBox=function(e,t,i,o){this.bbox[0]=e,this.bbox[1]=t,this.bbox[2]=i,this.bbox[3]=o,this.size=(i-e+o-t)/2},i.prototype._newSubRegion=function(){var e=this.subRegions[this.nSubRegions];return e||(e=new i,this.subRegions[this.nSubRegions]=e),this.nSubRegions++,e},i.prototype._addNodeToSubRegion=function(e){var t=this.findSubRegion(e.position[0],e.position[1]),i=this.bbox;if(!t){var o=(i[0]+i[2])/2,s=(i[1]+i[3])/2,r=(i[2]-i[0])/2,a=(i[3]-i[1])/2,n=e.position[0]>=o?1:0,h=e.position[1]>=s?1:0,t=this._newSubRegion();t.setBBox(n*r+i[0],h*a+i[1],(n+1)*r+i[0],(h+1)*a+i[1])}t.addNode(e)},i.prototype._updateCenterOfMass=function(e){null==this.centerOfMass&&(this.centerOfMass=a.create());var t=this.centerOfMass[0]*this.mass,i=this.centerOfMass[1]*this.mass;t+=e.position[0]*e.mass,i+=e.position[1]*e.mass,this.mass+=e.mass,this.centerOfMass[0]=t/this.mass,this.centerOfMass[1]=i/this.mass},r.prototype.nodeToNodeRepulsionFactor=function(e,t,i){return i*i*e/t},r.prototype.edgeToNodeRepulsionFactor=function(e,t,i){return i*e/t},r.prototype.attractionFactor=function(e,t,i){return e*t/i},r.prototype.initNodes=function(e,t,i){this.temperature=1;var s=e.length/2;this.nodes.length=0;for(var r=void 0!==i,a=0;s>a;a++){var n=new o;n.position[0]=e[2*a],n.position[1]=e[2*a+1],n.mass=t[a],r&&(n.size=i[a]),this.nodes.push(n)}this._massArr=t,r&&(this._sizeArr=i)},r.prototype.initEdges=function(e,t){var i=e.length/2;this.edges.length=0;for(var o=void 0!==t,r=0;i>r;r++){var a=e[2*r],n=e[2*r+1],h=this.nodes[a],d=this.nodes[n];if(h&&d){h.outDegree++,d.inDegree++;var l=new s(h,d);o&&(l.weight=t[r]),this.edges.push(l)}}},r.prototype.update=function(){var e=this.nodes.length;if(this.updateBBox(),this._k=.4*this.scaling*Math.sqrt(this.width*this.height/e),this.barnesHutOptimize){this._rootRegion.setBBox(this.bbox[0],this.bbox[1],this.bbox[2],this.bbox[3]),this._rootRegion.beforeUpdate();for(var t=0;e>t;t++)this._rootRegion.addNode(this.nodes[t]);this._rootRegion.afterUpdate()}else{var i=0,o=this._rootRegion.centerOfMass;a.set(o,0,0);for(var t=0;e>t;t++){var s=this.nodes[t];i+=s.mass,a.scaleAndAdd(o,o,s.position,s.mass)}i>0&&a.scale(o,o,1/i)}this.updateForce(),this.updatePosition()},r.prototype.updateForce=function(){for(var e=this.nodes.length,t=0;e>t;t++){var i=this.nodes[t];a.copy(i.forcePrev,i.force),a.copy(i.speedPrev,i.speed),a.set(i.force,0,0)}this.updateNodeNodeForce(),this.gravity>0&&this.updateGravityForce(),this.updateEdgeForce(),this.preventNodeEdgeOverlap&&this.updateNodeEdgeForce()},r.prototype.updatePosition=function(){for(var e=this.nodes.length,t=a.create(),i=0;e>i;i++){var o=this.nodes[i],s=o.speed;a.scale(o.force,o.force,1/30);var r=a.len(o.force)+.1,n=Math.min(r,500)/r;a.scale(o.force,o.force,n),a.add(s,s,o.force),a.scale(s,s,this.temperature),a.sub(t,s,o.speedPrev);var h=a.len(t);if(h>0){a.scale(t,t,1/h);var d=a.len(o.speedPrev);d>0&&(h=Math.min(h/d,this.maxSpeedIncrease)*d,a.scaleAndAdd(s,o.speedPrev,t,h))}var l=a.len(s),n=Math.min(l,100)/(l+.1);a.scale(s,s,n),a.add(o.position,o.position,s)}},r.prototype.updateNodeNodeForce=function(){for(var e=this.nodes.length,t=0;e>t;t++){var i=this.nodes[t];if(this.barnesHutOptimize)this.applyRegionToNodeRepulsion(this._rootRegion,i);else for(var o=t+1;e>o;o++){var s=this.nodes[o];this.applyNodeToNodeRepulsion(i,s,!1)}}},r.prototype.updateGravityForce=function(){for(var e=0;e<this.nodes.length;e++)this.applyNodeGravity(this.nodes[e])},r.prototype.updateEdgeForce=function(){for(var e=0;e<this.edges.length;e++)this.applyEdgeAttraction(this.edges[e])},r.prototype.updateNodeEdgeForce=function(){for(var e=0;e<this.nodes.length;e++)for(var t=0;t<this.edges.length;t++)this.applyEdgeToNodeRepulsion(this.edges[t],this.nodes[e])},r.prototype.applyRegionToNodeRepulsion=function(){var e=a.create();return function(t,i){if(t.node)this.applyNodeToNodeRepulsion(t.node,i,!0);else{if(0===t.mass&&0===i.mass)return;a.sub(e,i.position,t.centerOfMass);var o=e[0]*e[0]+e[1]*e[1];if(o>this.barnesHutTheta*t.size*t.size){var s=this._k*this._k*(i.mass+t.mass)/(o+1);a.scaleAndAdd(i.force,i.force,e,2*s)}else for(var r=0;r<t.nSubRegions;r++)this.applyRegionToNodeRepulsion(t.subRegions[r],i)}}}(),r.prototype.applyNodeToNodeRepulsion=function(){var e=a.create();return function(t,i,o){if(t!==i&&(0!==t.mass||0!==i.mass)){a.sub(e,t.position,i.position);var s=e[0]*e[0]+e[1]*e[1];if(0!==s){var r,n=t.mass+i.mass,h=Math.sqrt(s);a.scale(e,e,1/h),this.preventNodeOverlap?(h=h-t.size-i.size,h>0?r=this.nodeToNodeRepulsionFactor(n,h,this._k):0>=h&&(r=this._k*this._k*10*n)):r=this.nodeToNodeRepulsionFactor(n,h,this._k),o||a.scaleAndAdd(t.force,t.force,e,2*r),a.scaleAndAdd(i.force,i.force,e,2*-r)}}}}(),r.prototype.applyEdgeAttraction=function(){var e=a.create();return function(t){var i=t.node1,o=t.node2;a.sub(e,i.position,o.position);var s,r=a.len(e);s=0===this.edgeWeightInfluence?1:1==this.edgeWeightInfluence?t.weight:Math.pow(t.weight,this.edgeWeightInfluence);var n;if(!(this.preventOverlap&&0>=(r=r-i.size-o.size))){var n=this.attractionFactor(s,r,this._k);a.scaleAndAdd(i.force,i.force,e,-n),a.scaleAndAdd(o.force,o.force,e,n)}}}(),r.prototype.applyNodeGravity=function(){var e=a.create();return function(t){a.sub(e,this.center,t.position),this.width>this.height?e[1]*=this.width/this.height:e[0]*=this.height/this.width;var i=a.len(e)/100;this.strongGravity?a.scaleAndAdd(t.force,t.force,e,i*this.gravity*t.mass):a.scaleAndAdd(t.force,t.force,e,this.gravity*t.mass/(i+1))}}(),r.prototype.applyEdgeToNodeRepulsion=function(){var e=a.create(),t=a.create(),i=a.create();return function(o,s){var r=o.node1,n=o.node2;if(r!==s&&n!==s){a.sub(e,n.position,r.position),a.sub(t,s.position,r.position);var h=a.len(e);a.scale(e,e,1/h);var d=a.dot(e,t);if(!(0>d||d>h)){a.scaleAndAdd(i,r.position,e,d);var l=a.dist(i,s.position)-s.size,p=this.edgeToNodeRepulsionFactor(s.mass,Math.max(l,.1),100);a.sub(e,s.position,i),a.normalize(e,e),a.scaleAndAdd(s.force,s.force,e,p),a.scaleAndAdd(r.force,r.force,e,-p),a.scaleAndAdd(n.force,n.force,e,-p)}}}}(),r.prototype.updateBBox=function(){for(var e=1/0,t=1/0,i=-1/0,o=-1/0,s=0;s<this.nodes.length;s++){var r=this.nodes[s].position;e=Math.min(e,r[0]),t=Math.min(t,r[1]),i=Math.max(i,r[0]),o=Math.max(o,r[1])}this.bbox[0]=e,this.bbox[1]=t,this.bbox[2]=i,this.bbox[3]=o},r.getWorkerCode=function(){var t=e.toString();return t.slice(t.indexOf("{")+1,t.lastIndexOf("return"))},n){var d=null;self.onmessage=function(e){if(e.data instanceof ArrayBuffer){if(!d)return;for(var t=new Float32Array(e.data),i=t.length/2,o=0;i>o;o++){var s=d.nodes[o];s.position[0]=t[2*o],s.position[1]=t[2*o+1]}}else switch(e.data.cmd){case"init":d||(d=new r),d.initNodes(e.data.nodesPosition,e.data.nodesMass,e.data.nodesSize),d.initEdges(e.data.edges,e.data.edgesWeight);break;case"updateConfig":if(d)for(var a in e.data.config)d[a]=e.data.config[a];break;case"update":var n=e.data.steps;if(d){var i=d.nodes.length,t=new Float32Array(2*i);d.temperature=e.data.temperature;for(var o=0;n>o;o++)d.update(),d.temperature*=e.data.coolDown;for(var o=0;i>o;o++){var s=d.nodes[o];t[2*o]=s.position[0],t[2*o+1]=s.position[1]}self.postMessage(t.buffer,[t.buffer])}else{var h=new Float32Array;self.postMessage(h.buffer,[h.buffer])}}}}return r});