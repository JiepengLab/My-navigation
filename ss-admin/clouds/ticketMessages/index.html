<!DOCTYPE html> <html> <head> <meta charset="utf-8"> <title>管理后台</title> <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"> <meta name="renderer" content="webkit"> <meta name="viewport" content="width=device-width,initial-scale=1,shrink-to-fit=no"> <link href="/sitefiles/assets/css/font-awesome-4.7.0.min.css?v=1695605096452" rel="stylesheet" type="text/css"> <link href="/sitefiles/assets/css/ionicons-2.0.0.min.css?v=1695605096452" rel="stylesheet" type="text/css"> <link href="/sitefiles/assets/lib/elementui/themechalk/index.css?v=1695605096452" rel="stylesheet" type="text/css"> <link href="/sitefiles/assets/css/element-ui.css?v=1695605096452" rel="stylesheet" type="text/css"> <link href="/sitefiles/assets/css/cloud.css?v=1695605096452" rel="stylesheet" type="text/css"> <style> .main-wrapper {
    padding: 0 30px;
  }

  .message-header {
    padding: 10px 15px;
    border-top: 1px solid #ddd;
    border-bottom: 1px solid #ddd;
    background-color: #f5f5f7;
  }

  .table-expand {
    font-size: 0;
    width: 100%;
    display: flex;
  }

  .table-expand label {
    width: 90px;
  }

  .table-expand .el-form-item {
    margin-right: 0;
    margin-bottom: 0;
    width: 25%;
  }

  .message-footer {
    border-top: 1px solid #ddd;
    border-bottom: 1px solid #ddd;
    background-color: #f5f5f7;
    padding-top: 20px;
    width: 100%;
    display: flex;
  }

  .message-list {
    font-size: 16px;
    background-color: #ebebeb;
    overflow-y: auto;
    padding-bottom: 20px;
    padding-top: 20px;
  }

  .message-item {
    width: 100%;
    display: flex;
    margin-top: 8px;
  }

  .message-item .avatar {
    margin: 0 10px;
  }

  .message-item--right {
    flex-direction: row-reverse;
  }

  .message-time {
    text-align: center;
    font-size: 12px;
    color: #999;
    line-height: 20px;
    margin-bottom: 0;
    margin-top: 10px;
    display: block;
  }

  .message-bubble {
    border: 1px solid #ddd;
    padding: 7px 10px;
    border-radius: 3px;
    max-width: 80%;
    position: relative;
  }

  .message-bubble p {
    margin: 0;
  }

  .message-item--left .message-bubble {
    background-color: #fff;
  }

  .message-item--left .message-bubble::before {
    content: '';
    width: 10px;
    height: 10px;
    background: #fff;
    top: 14px;
    left: -6px;
    transform: rotate(-45deg);
    border-radius: 0 0 20px 0;
  }

  .message-item--right .message-bubble {
    background-color: #9fe759;
    border-color: #87cd51;
  }

  .message-item--right .message-bubble::before {
    content: '';
    width: 10px;
    height: 10px;
    background-color: #9fe759;
    top: 14px;
    right: -6px;
    transform: rotate(135deg);
    border-radius: 0 0 20px 0;
  }

  .message-document {
    width: 200px;
    text-align: center;
    font-size: 16px;
    color: #000;
  }

  .message-document i {
    display: block;
    font-size: 32px;
    margin-top: 15px;
    margin-bottom: 15px;
    color: #000;
  }

  .message-document span {
    display: inline-block;
    padding: 0 3px;
    margin-bottom: 15px;
  } </style> </head> <body> <div id="main"> <div v-if="this.pageLoad" style="display: none" :style="{display: ''}"> <div class="main-wrapper"> <div style="height: 5px"></div> <div class="message-header"> <el-form label-position="left" inline class="table-expand"> <el-form-item label="工单编号"> <span>{{ ticket.ticketNo }}</span> </el-form-item> <el-form-item label="优先级"> <span>{{ getTicketPriority() }}</span> </el-form-item> <el-form-item label="工单类型"> {{ getTicketCategory() }} <span v-if="ticket.resourceId">{{ ticket.resourceId }}</span> </el-form-item> <el-form-item label="提交时间"> <span>{{ ticket.createdDate }}</span> </el-form-item> <el-form-item label="工单状态"> <el-tag :type="getTicketStatusType()">{{ getTicketStatus() }}</el-tag> </el-form-item> <el-form-item label="" v-if="ticket.status !== 'Closed'"> <el-button type="danger" v-on:click="btnCloseClick">关闭工单</el-button> </el-form-item> </el-form> </div> <div class="message-list"> <div v-for="message in messages" :key="message.id"> <div class="message-time"> {{ message.createdDate }} </div> <div :class="getClassName(message)" class="message-item"> <el-avatar v-if="message.isReply" :size="35" class="avatar" src="https://sscms.com/home/img/assistant.svg"></el-avatar> <el-avatar v-else :size="35" class="avatar" :src="getAvatarUrl()"></el-avatar> <div class="message-bubble"> <template v-if="isImage(message)"> <el-link :underline="false" :href="getStorageUrl(message)" target="_blank"> <el-image :src="getStorageUrl(message)" lazy> <template #placeholder> <div class="image-slot"> 加载中 <span class="dot">...</span> </div> </template> </el-image> </el-link> </template> <template v-else-if="isDocument(message)"> <el-link :underline="false" target="_blank" :href="getStorageUrl(message)"> <div class="message-document"> <i class="el-icon-paperclip"></i> <span v-html="message.content"></span> </div> </el-link> </template> <template v-else> <span v-html="message.content"></span> </template> </div> </div> </div> </div> <div v-if="isInputArea()" class="message-footer"> <el-form label-position="left" ref="form" :model="form" style="width: 100%; margin: 10px"> <el-form-item> <el-upload :drag="true" :action="uploadUrl" :auto-upload="true" :headers="{ Authorization: 'Bearer ' + uploadToken }" :show-file-list="false" :before-upload="uploadBefore" :on-progress="uploadProgress" :on-success="uploadSuccess" :on-error="uploadError" :multiple="false"> <i class="el-icon-upload"></i> <div class="el-upload__text"> 将文件拖到此处，或 <em>点击上传</em> </div> </el-upload> </el-form-item> <el-form-item> <el-input type="textarea" :rows="2" :autosize="{ minRows: 4, maxRows: 10 }" placeholder="请输入内容，支持 Markdown 标签" v-model="form.content"></el-input> </el-form-item> <el-form-item align="center"> <el-button type="primary" v-on:click="btnSubmitClick">提 交</el-button> </el-form-item> </el-form> </div> </div> </div> <div v-else :style="{top: ($(window).height()/2 - 30) + 'px'}" v-loading="true" element-loading-text="页面加载中"></div> </div> </body> </html> <script src="/sitefiles/assets/lib/es6-promise.auto.min.js?v=1695605096452" type="text/javascript"></script> <script src="/sitefiles/assets/lib/axios-0.17.1.min.js?v=1695605096452" type="text/javascript"></script> <script src="/sitefiles/assets/lib/core-js-3.6.5.min.js?v=1695605096452" type="text/javascript"></script> <script src="/sitefiles/assets/lib/lodash-4.17.10.min.js?v=1695605096452" type="text/javascript"></script> <script src="/sitefiles/assets/lib/jquery-3.6.4.min.js?v=1695605096452" type="text/javascript"></script> <script src="/sitefiles/assets/lib/layer/layer-3.1.1.js?v=1695605096452" type="text/javascript"></script> <script src="/sitefiles/assets/lib/sweetalert2-7.28.4.all.min.js?v=1695605096452" type="text/javascript"></script> <script src="/sitefiles/assets/lib/vue-2.6.14.min.js?v=1695605096452" type="text/javascript"></script> <script src="/sitefiles/assets/lib/elementui/index.js?v=1695605096452"></script> <script src="/sitefiles/assets/lib/ElTableDraggable.umd.min.js?v=1695605096452" type="text/javascript"></script> <script src="/sitefiles/assets/js/admin.js?v=1695605096452" type="text/javascript"></script> <script src="/sitefiles/assets/js/utils.js?v=1695605096452" type="text/javascript"></script> <script src="/sitefiles/assets/js/cloud.js?v=1695605096452" type="text/javascript"></script> <script src="/sitefiles/assets/js/admin/clouds/ticketMessages.js?v=1695605096452" type="text/javascript"></script> 